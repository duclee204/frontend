import { Injectable } from '@angular/core';
import { Validators } from '@angular/forms';
import * as i0 from "@angular/core";
export class ValidationService {
    /**
     * validate required with no space
     */
    static required(control) {
        if (control.value === null || control.value === '') {
            return { required: true };
        }
        else if (('' + control.value).trim() === '') {
            return { required: true };
        }
        else {
            return null;
        }
    }
    /**
     * validate required with no space
     */
    static noWhiteSpace(control) {
        if (control.value.indexOf(' ') >= 0) {
            return { cannotContainSpace: true };
        }
        return null;
    }
    static maxLength(length) {
        return (c) => {
            if (c.value) {
                if ((c.value + '').replace(/\n/g, '\r\n').length > length) {
                    return { 'maxlength': { 'requiredLength': length } };
                }
            }
            return null;
        };
    }
    static passwordValidator(control) {
        if (!control.value) {
            return;
        }
        // {6,100}           - Assert password is between 6 and 100 characters
        // (?=.*[0-9])       - Assert a string has at least one number
        // (?!.*\s)          - Spaces are not allowed
        return (control.value.match(/^(?=.*\d)(?=.*[a-zA-Z!@#$%^&*])(?!.*\s).{6,100}$/)) ? '' : { invalidPassword: true };
    }
    /**
     * validate onlyLetterNumber
     */
    static onlyLetterNumber(control) {
        if (!control.value) {
            return;
        }
        return (control.value.match(/^[0-9a-zA-Z]+$/)) ? '' : { onlyLetterNumber: true };
    }
    /**
     * validate onlyLetterNumberSp
     */
    static onlyLetterNumberSp(control) {
        if (!control.value) {
            return;
        }
        return (control.value.match(/^[0-9a-zA-Z\ ]+$/)) ? '' : { onlyLetterNumber: true };
    }
    /**
     * validate database tableColumnName
     */
    static dbTableColumnName(control) {
        if (!control.value) {
            return;
        }
        return (control.value.match(/^[0-9a-zA-Z_]+$/)) ? '' : { dbTableColumnName: true };
    }
    /**
     * validate personalIdNumber
     */
    static personalIdNumber(control) {
        if (!control.value) {
            return;
        }
        return (control.value.match(/^[0-9a-zA-Z]{8,15}$/)) ? '' : { personalIdNumber: true };
    }
    /**
     * validate phone
     */
    static phone(control) {
        if (!control.value) {
            return;
        }
        return (control.value.match(/^([\+])?(\d([.\s])?){1,15}$/)) ? '' : { phone: true };
    }
    /**
     * validate mobileNumber
     */
    static mobileNumber(control) {
        if (!control.value) {
            return;
        }
        return (control.value.match(/^([+][0-9]{1,3}([ .-])?)?([(][0-9]{1,6}[)])?([0-9 .-]{1,32})(([A-Za-z :]{1,11})?[0-9]{1,4}?)$/))
            ? '' : { mobileNumber: true };
    }
    /**
     * validate integer
     */
    static integer(control) {
        if (!control.value) {
            return;
        }
        return (control.value.toString().trim().match(/^[\-\+]?\d+$/)) ? '' : { integer: true };
    }
    /**
     * validate positiveInteger
     */
    static positiveInteger(control) {
        if (!control.value) {
            return;
        }
        return (control.value.toString().trim().match(/^\d+$/)) ? '' : { positiveInteger: true };
    }
    /**
     * validate number
     */
    static number(control) {
        if (!control.value) {
            return;
        }
        return (control.value.toString().trim().match(/^[\-\+]?(([0-9]+)([\.]([0-9]+))?|([\.]([0-9]+))?)$/))
            ? '' : { number: true };
    }
    /**
     * validate positiveNumber
     */
    static positiveNumber(control) {
        if (!control.value) {
            return;
        }
        return (control.value.toString().trim().match(/^(([0-9]+)([\.]([0-9]+))?|([\.]([0-9]+))?)$/))
            ? '' : { positiveNumber: true };
    }
    /**
   * validate beforeCurrentDate
   */
    static beforeCurrentDate(control) {
        if (!control.value) {
            return;
        }
        const x = new Date().getTime();
        return (control.value < x)
            ? '' : { beforeCurrentDate: true };
    }
    static afterCurrentDate(control) {
        if (!control.value) {
            return;
        }
        const x = new Date().getTime();
        return (control.value >= x || x - control.value < 99999999)
            ? '' : { afterCurrentDate: true };
    }
    /**
     * Validate IP
     * @param control : any
     */
    static isIp(control) {
        if (!control.value) {
            return;
        }
        const str = '^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.'
            + '){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$';
        const regExp = new RegExp(str);
        if (!regExp.test(control.value)) {
            return { isIp: true };
        }
        return '';
    }
    /**
   * Validate URL
   * @param control : any
   */
    static isUrl(control) {
        if (!control.value) {
            return;
        }
        const str = '(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|' +
            'www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|' +
            'https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9]\.[^\s]{2,})';
        const regExp = new RegExp(str);
        if (!regExp.test(control.value)) {
            return { isUrl: true };
        }
        return '';
    }
    /** Validate email format */
    static emailFormat(control) {
        if (!control.value) {
            return;
        }
        // tslint:disable-next-line: max-line-length
        return (control.value.toString().trim().match(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i))
            ? '' : { invalidEmail: true };
    }
    /**
     * Validate date not affter date
     * @param targetKey: any
     * @param toMatchKey: any
     */
    static notAffter(targetKey, toMatchKey, labelMatchCode) {
        return (group) => {
            const target = group.controls[targetKey];
            const toMatch = group.controls[toMatchKey];
            if (target.hasError('dateNotAffter')) {
                target.setErrors(null);
                target.markAsUntouched();
            }
            if (target.value && toMatch.value) {
                const isCheck = target.value <= toMatch.value;
                // set equal value error on dirty controls
                if (!isCheck && target.valid && toMatch.valid) {
                    target.setErrors({ dateNotAffter: { dateNotAffter: labelMatchCode } });
                    target.markAsTouched();
                }
            }
            return null;
        };
    }
    /**
    * Validate date not before date
    * @param targetKey: any
    * @param toMatchKey: any
    */
    static notBefore(targetKey, toMatchKey, labelMatchCode) {
        return (group) => {
            const target = group.controls[targetKey];
            const toMatch = group.controls[toMatchKey];
            if (target.hasError('dateNotBefore')) {
                target.setErrors(null);
                target.markAsUntouched();
            }
            if (target.value && toMatch.value) {
                const isCheck = target.value >= toMatch.value;
                // set equal value error on dirty controls
                if (!isCheck && target.valid && toMatch.valid) {
                    target.setErrors({ dateNotBefore: { dateNotBefore: labelMatchCode } });
                    target.markAsTouched();
                }
            }
            return null;
        };
    }
    /**
     * Validate date not affter number
     * @param targetKey: any
     * @param toMatchKey: any
     */
    static notAffterNumber(targetKey, toMatchKey, labelMatchCode) {
        return (group) => {
            const target = group.controls[targetKey];
            const toMatch = group.controls[toMatchKey];
            // neu mot trong hai truong null thi chuyen sang require
            if (!target || !toMatch) {
                return null;
            }
            // dieu kien kiem tra
            if (target.hasError('dateNotAffter')) {
                target.setErrors(null);
                target.markAsUntouched();
            }
            const targetValue = parseFloat(target.value);
            const toMatchValue = parseFloat(toMatch.value);
            if (targetValue && toMatchValue) {
                const isCheck = targetValue <= toMatchValue;
                // set equal value error on dirty controls
                if (!isCheck && target.valid && toMatch.valid) {
                    target.setErrors({ dateNotAffter: { dateNotAffter: labelMatchCode } });
                    target.markAsTouched();
                }
            }
            return null;
        };
    }
    /**
     * Validate date in range 6 Month
     * @param targetKey: any
     * @param toMatchKey: any
     */
    static isRangeOf6Month(targetKey, toMatchKey, labelMatchCode) {
        return (group) => {
            const target = group.controls[targetKey];
            const toMatch = group.controls[toMatchKey];
            // kiem tra null
            if (target.hasError('isRangeOf6Month')) {
                target.setErrors(null);
                target.markAsUntouched();
            }
            let temp = new Date(target.value);
            temp.setMonth(temp.getMonth() + 6);
            // kiem tra  gia tri
            if (target.value && toMatch.value) {
                const isCheck = temp >= new Date(toMatch.value);
                // set equal value error on dirty controls
                if (!isCheck) {
                    target.setErrors({ isRangeOf6Month: { dateNotAffter: labelMatchCode } });
                    target.markAsTouched();
                }
            }
            return null;
        };
    }
    /**
     * Validate date not before a specify date
     * @param targetKey: any
     * @param specifyDate: any
     */
    static beforeSpecifyDate(targetKey, specifyDate, labelMatchCode) {
        return (group) => {
            const target = group.controls[targetKey];
            // Neu mot trong hai truong null
            if (!target || !specifyDate) {
                return null;
            }
            // Dieu kien kiem tra
            if (target.hasError('dateNotBefore')) {
                target.setErrors(null);
                target.markAsUntouched();
            }
            const targetValue = parseFloat(target.value);
            const toMatchValue = parseFloat(specifyDate);
            if (targetValue || targetValue === 0 && toMatchValue) {
                const isCheck = targetValue >= toMatchValue;
                // Set equal value error on dirty controls
                if (!isCheck && target.valid) {
                    target.setErrors({ dateNotBefore: { dateNotBefore: labelMatchCode } });
                    target.markAsTouched();
                }
            }
            return null;
        };
    }
    /**
     * Validate date not after a specify date
     * @param targetKey: any
     * @param specifyDate: any
     */
    static afterSpecifyDate(targetKey, specifyDate, labelMatchCode) {
        return (group) => {
            const target = group.controls[targetKey];
            // Neu mot trong hai truong null
            if (!target || !specifyDate) {
                return null;
            }
            // Dieu kien kiem tra
            if (target.hasError('dateNotAffter')) {
                target.setErrors(null);
                target.markAsUntouched();
            }
            const targetValue = parseFloat(target.value);
            const toMatchValue = parseFloat(specifyDate);
            if (targetValue || targetValue === 0 && toMatchValue) {
                const isCheck = targetValue <= toMatchValue;
                // Set equal value error on dirty controls
                if (!isCheck && target.valid) {
                    target.setErrors({ dateNotAffter: { dateNotAffter: labelMatchCode } });
                    target.markAsTouched();
                }
            }
            return null;
        };
    }
    /**
     * Validate date not before number
     * @param targetKey: any
     * @param toMatchKey: any
     */
    static notBeforeNumber(targetKey, toMatchKey, labelMatchCode) {
        return (group) => {
            const target = group.controls[targetKey];
            const toMatch = group.controls[toMatchKey];
            // neu mot trong hai truong null thi chuyen sang require
            if (!target || !toMatch) {
                return null;
            }
            // dieu kien kiem tra
            if (target.hasError('dateNotBefore')) {
                target.setErrors(null);
                target.markAsUntouched();
            }
            const targetValue = parseFloat(target.value);
            const toMatchValue = parseFloat(toMatch.value);
            if (targetValue || targetValue === 0 && toMatchValue) {
                const isCheck = targetValue >= toMatchValue;
                // set equal value error on dirty controls
                if (!isCheck && target.valid && toMatch.valid) {
                    target.setErrors({ dateNotBefore: { dateNotBefore: labelMatchCode } });
                    target.markAsTouched();
                }
            }
            return null;
        };
    }
    static getValidatorArr(oldArr, prop) {
        const validators = new Array();
        if (oldArr && oldArr.length > 0 && (prop === null || prop === undefined)) {
            return oldArr;
        }
        if (prop === null || prop === undefined || prop.isHide === true) {
            return validators;
        }
        if (prop.isRequire) {
            validators.push(ValidationService.required);
        }
        if (prop.isEmail) {
            validators.push(Validators.email);
        }
        if (prop.isNumber) {
            validators.push(ValidationService.number);
        }
        if (prop.isUrl) {
            validators.push(ValidationService.isUrl);
        }
        if (prop.isIp) {
            validators.push(ValidationService.isIp);
        }
        if (prop.minLength) {
            validators.push(Validators.minLength(prop.minLength));
        }
        if (prop.maxLength) {
            validators.push(ValidationService.maxLength(prop.maxLength));
        }
        if (prop.numberMin) {
            validators.push(Validators.min(prop.numberMin));
        }
        if (prop.numberMax) {
            validators.push(Validators.max(prop.numberMax));
        }
        if (prop.password) {
            validators.push(ValidationService.passwordValidator);
        }
        if (prop.phone) {
            validators.push(ValidationService.phone);
        }
        if (prop.mobileNumber) {
            validators.push(ValidationService.mobileNumber);
        }
        if (prop.personalIdNumber) {
            validators.push(ValidationService.personalIdNumber);
        }
        if (prop.beforeCurrentDate) {
            validators.push(ValidationService.beforeCurrentDate);
        }
        if (prop.numberType) {
            switch (prop.numberType) {
                case 'isNumber':
                    validators.push(ValidationService.number);
                    break;
                case 'positiveNumber':
                    validators.push(ValidationService.positiveNumber);
                    break;
                case 'integer':
                    validators.push(ValidationService.integer);
                    break;
                case 'positiveInteger':
                    validators.push(ValidationService.positiveInteger);
                    break;
                case 'positiveRealNumber':
                    validators.push(ValidationService.positiveRealNumber);
                    break;
            }
        }
        if (prop.emailFormat) {
            validators.push(ValidationService.emailFormat);
        }
        return validators;
    }
    /**
       * Validate 'Đơn vị, Chức danh công việc không được phép trùng'
       * @param targetKey: any
       * @param toMatchKey: any
       */
    static duplicateArray(controlKeys, target, messageKey) {
        return (array) => {
            // target.setErrors({duplicateArray: {duplicateName: messageKey}});
            // target.markAsTouched();
            const map = {};
            for (const group of array.controls) {
                const controlTaget = group.get(target);
                let count = 0;
                const values = [];
                for (const key of controlKeys) {
                    const control = group.get(key);
                    if (control.value !== null && control.value !== '') {
                        values.push(control.value);
                        count++;
                    }
                }
                let k = '/' + values.join('/') + '/';
                k = k.toLowerCase();
                if (controlKeys.length === count) {
                    if (map.hasOwnProperty(k)) {
                        controlTaget.setErrors({ duplicateArray: { duplicateArray: messageKey } });
                        controlTaget.markAsTouched();
                    }
                    else {
                        map[k] = true;
                        // fix bug khi xoa row dau khi bi duplicate
                        if (controlTaget.hasError('duplicateArray')) {
                            controlTaget.setErrors(null);
                            controlTaget.markAsUntouched();
                        }
                    }
                }
            }
            return null;
        };
    }
    // Hàm xử lý validate bắt buộc nhập các trường còn lại nếu có 1 trường trong danh sách được nhập
    static requiredIfHaveOne(control) {
        let isRequire = false;
        const group = control.parent;
        Object.keys(group.controls).forEach(key => {
            const controlEl = group.get(key);
            if (controlEl.propertyName !== control.propertyName) {
                if (controlEl.listValidation) {
                    for (const f of controlEl.listValidation) {
                        const fn = f;
                        if (fn === ValidationService.requiredIfHaveOne && controlEl.value) {
                            isRequire = true;
                        }
                    }
                }
            }
        });
        if (isRequire && !control.value) {
            return { requiredIfHaveOne: true };
        }
        return null;
    }
    /**
     * Xu ly neu nhu co gia tri tai truong hien tai thi validate bat buoc nhap tai truong duoc set
     * @param controlKeys Ten truong bat buoc nhap
     */
    static ifHaveOneIsRequired(controlKeys) {
        return (c) => {
            const group = c.parent;
            const controlRequired = group.get(controlKeys);
            if (c.value !== null && c.value.toString().length > 0) { //  vi co th value = []
                if (controlRequired.value === null || controlRequired.value === '') {
                    controlRequired.setErrors({ ifHaveOneIsRequired: true });
                    controlRequired.markAsTouched();
                }
                else {
                    if (controlRequired.hasError('ifHaveOneIsRequired')) {
                        controlRequired.setErrors(null);
                        controlRequired.markAsUntouched();
                    }
                }
            }
            else {
                if (controlRequired.hasError('ifHaveOneIsRequired')) {
                    controlRequired.setErrors(null);
                    controlRequired.markAsUntouched();
                }
            }
        };
    }
    /**
     * Xu ly bat buoc nhap truong hien tai khi truong truyen vao co gia tri
     * @param controlKeys Ten truong nhap gia tri
     */
    static isRequiredIfHaveOne(controlKeys) {
        return (c) => {
            const group = c.parent;
            const controlHaveOne = group.get(controlKeys);
            if (c.value === null || c.value === '') {
                if (controlHaveOne && (controlHaveOne.value === null || controlHaveOne.value.toString().length === 0)) { //  vi co th value = []
                    return null;
                }
                else {
                    return { ifHaveOneIsRequired: true };
                }
            }
            else {
                return null;
            }
        };
    }
    /**
     * validate array form requird
     * Neu ko nhap truong nao thi ko validate, khi nhap 1 trong cac truong  thi bat buoc nhap tat ca cac truong cau hinh
     */
    static requiredControlInGroup(controlKeys, controlKeysIgnore) {
        return (group) => {
            let checkExitsValue = false;
            Object.keys(group.controls).forEach(key => {
                if (controlKeysIgnore && controlKeysIgnore.includes(key)) {
                    return true;
                }
                const controlEl = group.get(key);
                if (!(controlEl.value === null || controlEl.value === '' || !controlEl.value)) {
                    checkExitsValue = true;
                }
                return false;
            });
            controlKeys.forEach(key => {
                const formControl = group.controls[key];
                if (checkExitsValue) {
                    if (formControl.value === null || formControl.value === '') {
                        formControl.setErrors({ requiredControlInGroup: true });
                        // formControl.markAsTouched();
                    }
                    else if (('' + formControl.value).trim() === '') {
                        formControl.setErrors({ requiredControlInGroup: true });
                        // formControl.markAsTouched();
                    }
                    else {
                        if (formControl.hasError('requiredControlInGroup')) {
                            formControl.setErrors(null);
                            formControl.markAsUntouched();
                        }
                    }
                }
                else {
                    if (formControl.hasError('requiredControlInGroup')) {
                        formControl.setErrors(null);
                        formControl.markAsUntouched();
                    }
                }
            });
            return null;
        };
    }
    /**
    * Xu ly validate bat buoc nhap 1 truong trong danh sach cau hinh
    */
    static justRequiredOneField(controlKeys) {
        return (group) => {
            let checkExitsValue = false;
            controlKeys.forEach(key => {
                const controlEl = group.get(key);
                if (controlEl.value !== null && controlEl.value !== '') {
                    checkExitsValue = true;
                }
            });
            controlKeys.forEach(key => {
                const formControl = group.get(key);
                if (checkExitsValue) {
                    if (formControl.hasError('justRequiredOneField')) {
                        formControl.setErrors(null);
                        formControl.markAsUntouched();
                    }
                }
                else {
                    if (!formControl.hasError('justRequiredOneField')) {
                        formControl.setErrors({ justRequiredOneField: true });
                        // formControl.markAsTouched();
                    }
                }
            });
            return null;
        };
    }
    static positiveRealNumber(control) {
        if (!control.value) {
            return;
        }
        return (control.value.toString().trim().match(/^(([0-9]+)([\.]([5]{1}))?)$/))
            ? '' : { positiveRealNumber: true };
    }
    static isRequiredIfHaveOneValue(controlKeys) {
        return (c) => {
            const group = c.parent;
            const controlHaveOne = group.get(controlKeys);
            if (c.value === null || c.value == "" || c.value.toString().length === 0) {
                if (controlHaveOne && (controlHaveOne.value === null || controlHaveOne.value === 0)) { //  vi co th value = []
                    return null;
                }
                else {
                    return { ifHaveOneIsRequired: true };
                }
            }
            else {
                return null;
            }
        };
    }
    static isRequiredReason(sabbaticalLeaveId, addDay, subDay) {
        return (c) => {
            const group = c.parent;
            const controlSabbaticalLeaveId = group.get(sabbaticalLeaveId);
            const controlAddAnuualDayLeave = group.get(addDay);
            const controlSubAnuualDayLeave = group.get(subDay);
            if (controlSabbaticalLeaveId.value) {
                if (c.value === null || c.value === "") {
                    return null;
                }
                else {
                    return { ifHaveOneIsRequired: true };
                }
            }
            else {
                if (controlSabbaticalLeaveId.value == null) {
                    if (controlAddAnuualDayLeave.value != null || controlSubAnuualDayLeave.value != null) {
                        if (c.value === null || c.value === "") {
                            return null;
                        }
                    }
                    else {
                        return { ifHaveOneIsRequired: true };
                    }
                }
            }
        };
    }
    static isHaveSabbaticalLeaveId(controlKeys) {
        return (c) => {
            const group = c.parent;
            const controlHaveOne = group.get(controlKeys);
            if (controlHaveOne.value) {
                if (c.value === null || c.value === "") {
                    return { ifHaveOneIsRequired: true };
                }
            }
            else {
                return null;
            }
        };
    }
    /**
     * Validate number not greater than number (selector)
     * @param targetKey: any
     * @param toMatchKey: any
     */
    static notGreater(targetKey, toMatchKey, labelMatchCode) {
        return (group) => {
            const target = group.controls[targetKey];
            const toMatch = group.controls[toMatchKey];
            if (target.hasError('numberNotGreater')) {
                target.setErrors(null);
                target.markAsUntouched();
            }
            if (target.value && toMatch.value) {
                const isCheck = Number(target.value) <= Number(toMatch.value);
                // set equal value error on dirty controls
                if (!isCheck && target.valid && toMatch.valid) {
                    target.setErrors({ numberNotGreater: { numberNotGreater: labelMatchCode } });
                    target.markAsTouched();
                }
            }
            return null;
        };
    }
    /**
    * validate beforeCurrentMonth
    */
    static beforeCurrentMonth(control) {
        if (!control.value) {
            return;
        }
        const x = new Date().getMonth() + 1;
        const y = new Date().getFullYear();
        var date = new Date(control.value);
        var month = date.getMonth() + 1;
        var year = date.getFullYear();
        var check = false;
        if (year < y) {
            check = true;
        }
        else if (year == y && month <= x) {
            check = true;
        }
        return (check == true)
            ? '' : { beforeCurrentMonth: true };
    }
    static afterCurrentMonth(control) {
        if (!control.value) {
            return;
        }
        const x = new Date().getMonth() + 1;
        return (control.value >= x || x - control.value < 99999999)
            ? '' : { afterCurrentMonth: true };
    }
    /**
     * validate 9 or 12
     */
    static lenght9or12(control) {
        if (!control.value) {
            return;
        }
        return (control.value.toString().trim().length == 9 || control.value.toString().trim().length == 12) ? '' : { lenght9or12: true };
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.5", ngImport: i0, type: ValidationService, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "16.2.5", ngImport: i0, type: ValidationService, providedIn: 'root' }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.5", ngImport: i0, type: ValidationService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdGlvbi5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvYW5ndWxhcngtc2NvcmUvc3JjL2xpYi9zaGFyZWQvc2VydmljZXMvdmFsaWRhdGlvbi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUEyQyxVQUFVLEVBQXlELE1BQU0sZ0JBQWdCLENBQUM7O0FBUzVJLE1BQU0sT0FBTyxpQkFBaUI7SUFFNUI7O09BRUc7SUFDSSxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQXdCO1FBQzdDLElBQUksT0FBTyxDQUFDLEtBQUssS0FBSyxJQUFJLElBQUksT0FBTyxDQUFDLEtBQUssS0FBSyxFQUFFLEVBQUU7WUFDbEQsT0FBTyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQztTQUMzQjthQUFNLElBQUksQ0FBQyxFQUFFLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsRUFBRTtZQUM3QyxPQUFPLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDO1NBQzNCO2FBQU07WUFDTCxPQUFPLElBQUksQ0FBQztTQUNiO0lBQ0gsQ0FBQztJQUNEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLFlBQVksQ0FBQyxPQUF3QjtRQUNqRCxJQUFLLE9BQU8sQ0FBQyxLQUFnQixDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDL0MsT0FBTyxFQUFFLGtCQUFrQixFQUFFLElBQUksRUFBRSxDQUFBO1NBQ3BDO1FBQ0QsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBQ00sTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFjO1FBQ3BDLE9BQU8sQ0FBQyxDQUFrQixFQUFjLEVBQUU7WUFDeEMsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFO2dC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QUFFLENBQUM7SUFDcEksQ0FBQzs4R0Fwd0JVLGlCQUFpQjtrSEFBakIsaUJBQWlCLGNBRmhCLE1BQU07OzJGQUVQLGlCQUFpQjtrQkFIN0IsVUFBVTttQkFBQztvQkFDVixVQUFVLEVBQUUsTUFBTTtpQkFDbkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEFic3RyYWN0Q29udHJvbCwgVmFsaWRhdG9yRm4sIEZvcm1Hcm91cCwgVmFsaWRhdG9ycywgRm9ybUJ1aWxkZXIsIEZvcm1BcnJheSwgRm9ybUNvbnRyb2wsIFZhbGlkYXRpb25FcnJvcnMgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IENvbW1vblV0aWxzIH0gZnJvbSAnLi9jb21tb24tdXRpbHMuc2VydmljZSc7XHJcbi8vIGltcG9ydCB7IGlzU3RyaW5nIH0gZnJvbSAndXRpbCc7XHJcbmltcG9ydCB7IFN5c1Byb3BlcnR5RGV0YWlsQmVhbiB9IGZyb20gJy4uL21vZGVscy9zeXMtcHJvcGVydHktZGV0YWlscy5tb2RlbCc7XHJcbmltcG9ydCB7IEJhc2VDb250cm9sIH0gZnJvbSAnLi4vbW9kZWxzL2Jhc2UuY29udHJvbCc7XHJcblxyXG5ASW5qZWN0YWJsZSh7XHJcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBWYWxpZGF0aW9uU2VydmljZSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIHZhbGlkYXRlIHJlcXVpcmVkIHdpdGggbm8gc3BhY2VcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIHJlcXVpcmVkKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IGFueSB7XHJcbiAgICBpZiAoY29udHJvbC52YWx1ZSA9PT0gbnVsbCB8fCBjb250cm9sLnZhbHVlID09PSAnJykge1xyXG4gICAgICByZXR1cm4geyByZXF1aXJlZDogdHJ1ZSB9O1xyXG4gICAgfSBlbHNlIGlmICgoJycgKyBjb250cm9sLnZhbHVlKS50cmltKCkgPT09ICcnKSB7XHJcbiAgICAgIHJldHVybiB7IHJlcXVpcmVkOiB0cnVlIH07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogdmFsaWRhdGUgcmVxdWlyZWQgd2l0aCBubyBzcGFjZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgbm9XaGl0ZVNwYWNlKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IGFueSB7XHJcbiAgICBpZiAoKGNvbnRyb2wudmFsdWUgYXMgc3RyaW5nKS5pbmRleE9mKCcgJykgPj0gMCkge1xyXG4gICAgICByZXR1cm4geyBjYW5ub3RDb250YWluU3BhY2U6IHRydWUgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG4gIHB1YmxpYyBzdGF0aWMgbWF4TGVuZ3RoKGxlbmd0aDogbnVtYmVyKTogVmFsaWRhdG9yRm4gfCBhbnl7XHJcbiAgICByZXR1cm4gKGM6IEFic3RyYWN0Q29udHJvbCk6IGFueSB8IG51bGwgPT4ge1xyXG4gICAgICBpZiAoYy52YWx1ZSkge1xyXG4gICAgICAgIGlmICgoYy52YWx1ZSArICcnKS5yZXBsYWNlKC9cXG4vZywgJ1xcclxcbicpLmxlbmd0aCA+IGxlbmd0aCkge1xyXG4gICAgICAgICAgcmV0dXJuIHsgJ21heGxlbmd0aCc6IHsgJ3JlcXVpcmVkTGVuZ3RoJzogbGVuZ3RoIH0gfTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBwYXNzd29yZFZhbGlkYXRvcihjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBhbnkge1xyXG4gICAgaWYgKCFjb250cm9sLnZhbHVlKSB7IHJldHVybjsgfVxyXG5cclxuICAgIC8vIHs2LDEwMH0gICAgICAgICAgIC0gQXNzZXJ0IHBhc3N3b3JkIGlzIGJldHdlZW4gNiBhbmQgMTAwIGNoYXJhY3RlcnNcclxuICAgIC8vICg/PS4qWzAtOV0pICAgICAgIC0gQXNzZXJ0IGEgc3RyaW5nIGhhcyBhdCBsZWFzdCBvbmUgbnVtYmVyXHJcbiAgICAvLyAoPyEuKlxccykgICAgICAgICAgLSBTcGFjZXMgYXJlIG5vdCBhbGxvd2VkXHJcbiAgICByZXR1cm4gKGNvbnRyb2wudmFsdWUubWF0Y2goL14oPz0uKlxcZCkoPz0uKlthLXpBLVohQCMkJV4mKl0pKD8hLipcXHMpLns2LDEwMH0kLykpID8gJycgOiB7IGludmFsaWRQYXNzd29yZDogdHJ1ZSB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogdmFsaWRhdGUgb25seUxldHRlck51bWJlclxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb25seUxldHRlck51bWJlcihjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBhbnkge1xyXG4gICAgaWYgKCFjb250cm9sLnZhbHVlKSB7IHJldHVybjsgfVxyXG4gICAgcmV0dXJuIChjb250cm9sLnZhbHVlLm1hdGNoKC9eWzAtOWEtekEtWl0rJC8pKSA/ICcnIDogeyBvbmx5TGV0dGVyTnVtYmVyOiB0cnVlIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiB2YWxpZGF0ZSBvbmx5TGV0dGVyTnVtYmVyU3BcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG9ubHlMZXR0ZXJOdW1iZXJTcChjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBhbnkge1xyXG4gICAgaWYgKCFjb250cm9sLnZhbHVlKSB7IHJldHVybjsgfVxyXG4gICAgcmV0dXJuIChjb250cm9sLnZhbHVlLm1hdGNoKC9eWzAtOWEtekEtWlxcIF0rJC8pKSA/ICcnIDogeyBvbmx5TGV0dGVyTnVtYmVyOiB0cnVlIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiB2YWxpZGF0ZSBkYXRhYmFzZSB0YWJsZUNvbHVtbk5hbWVcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGRiVGFibGVDb2x1bW5OYW1lKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IGFueSB7XHJcbiAgICBpZiAoIWNvbnRyb2wudmFsdWUpIHsgcmV0dXJuOyB9XHJcbiAgICByZXR1cm4gKGNvbnRyb2wudmFsdWUubWF0Y2goL15bMC05YS16QS1aX10rJC8pKSA/ICcnIDogeyBkYlRhYmxlQ29sdW1uTmFtZTogdHJ1ZSB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogdmFsaWRhdGUgcGVyc29uYWxJZE51bWJlclxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgcGVyc29uYWxJZE51bWJlcihjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBhbnkge1xyXG4gICAgaWYgKCFjb250cm9sLnZhbHVlKSB7IHJldHVybjsgfVxyXG4gICAgcmV0dXJuIChjb250cm9sLnZhbHVlLm1hdGNoKC9eWzAtOWEtekEtWl17OCwxNX0kLykpID8gJycgOiB7IHBlcnNvbmFsSWROdW1iZXI6IHRydWUgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHZhbGlkYXRlIHBob25lXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBwaG9uZShjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBhbnkge1xyXG4gICAgaWYgKCFjb250cm9sLnZhbHVlKSB7IHJldHVybjsgfVxyXG4gICAgcmV0dXJuIChjb250cm9sLnZhbHVlLm1hdGNoKC9eKFtcXCtdKT8oXFxkKFsuXFxzXSk/KXsxLDE1fSQvKSkgPyAnJyA6IHsgcGhvbmU6IHRydWUgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHZhbGlkYXRlIG1vYmlsZU51bWJlclxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgbW9iaWxlTnVtYmVyKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IGFueSB7XHJcbiAgICBpZiAoIWNvbnRyb2wudmFsdWUpIHsgcmV0dXJuOyB9XHJcbiAgICByZXR1cm4gKGNvbnRyb2wudmFsdWUubWF0Y2goL14oWytdWzAtOV17MSwzfShbIC4tXSk/KT8oWyhdWzAtOV17MSw2fVspXSk/KFswLTkgLi1dezEsMzJ9KSgoW0EtWmEteiA6XXsxLDExfSk/WzAtOV17MSw0fT8pJC8pKVxyXG4gICAgICA/ICcnIDogeyBtb2JpbGVOdW1iZXI6IHRydWUgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHZhbGlkYXRlIGludGVnZXJcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGludGVnZXIoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogYW55IHtcclxuICAgIGlmICghY29udHJvbC52YWx1ZSkgeyByZXR1cm47IH1cclxuICAgIHJldHVybiAoY29udHJvbC52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5tYXRjaCgvXltcXC1cXCtdP1xcZCskLykpID8gJycgOiB7IGludGVnZXI6IHRydWUgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHZhbGlkYXRlIHBvc2l0aXZlSW50ZWdlclxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgcG9zaXRpdmVJbnRlZ2VyKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IGFueSB7XHJcbiAgICBpZiAoIWNvbnRyb2wudmFsdWUpIHsgcmV0dXJuOyB9XHJcbiAgICByZXR1cm4gKGNvbnRyb2wudmFsdWUudG9TdHJpbmcoKS50cmltKCkubWF0Y2goL15cXGQrJC8pKSA/ICcnIDogeyBwb3NpdGl2ZUludGVnZXI6IHRydWUgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHZhbGlkYXRlIG51bWJlclxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgbnVtYmVyKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IGFueSB7XHJcbiAgICBpZiAoIWNvbnRyb2wudmFsdWUpIHsgcmV0dXJuOyB9XHJcbiAgICByZXR1cm4gKGNvbnRyb2wudmFsdWUudG9TdHJpbmcoKS50cmltKCkubWF0Y2goL15bXFwtXFwrXT8oKFswLTldKykoW1xcLl0oWzAtOV0rKSk/fChbXFwuXShbMC05XSspKT8pJC8pKVxyXG4gICAgICA/ICcnIDogeyBudW1iZXI6IHRydWUgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHZhbGlkYXRlIHBvc2l0aXZlTnVtYmVyXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBwb3NpdGl2ZU51bWJlcihjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBhbnkge1xyXG4gICAgaWYgKCFjb250cm9sLnZhbHVlKSB7IHJldHVybjsgfVxyXG4gICAgcmV0dXJuIChjb250cm9sLnZhbHVlLnRvU3RyaW5nKCkudHJpbSgpLm1hdGNoKC9eKChbMC05XSspKFtcXC5dKFswLTldKykpP3woW1xcLl0oWzAtOV0rKSk/KSQvKSlcclxuICAgICAgPyAnJyA6IHsgcG9zaXRpdmVOdW1iZXI6IHRydWUgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gKiB2YWxpZGF0ZSBiZWZvcmVDdXJyZW50RGF0ZVxyXG4gKi9cclxuICBwdWJsaWMgc3RhdGljIGJlZm9yZUN1cnJlbnREYXRlKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IGFueSB7XHJcbiAgICBpZiAoIWNvbnRyb2wudmFsdWUpIHsgcmV0dXJuOyB9XHJcbiAgICBjb25zdCB4ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbiAgICByZXR1cm4gKGNvbnRyb2wudmFsdWUgPCB4KVxyXG4gICAgICA/ICcnIDogeyBiZWZvcmVDdXJyZW50RGF0ZTogdHJ1ZSB9O1xyXG4gIH1cclxuICBwdWJsaWMgc3RhdGljIGFmdGVyQ3VycmVudERhdGUoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogYW55IHtcclxuICAgIGlmICghY29udHJvbC52YWx1ZSkgeyByZXR1cm47IH1cclxuICAgIGNvbnN0IHggPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgIHJldHVybiAoY29udHJvbC52YWx1ZSA+PSB4IHx8IHggLSBjb250cm9sLnZhbHVlIDwgOTk5OTk5OTkpXHJcbiAgICAgID8gJycgOiB7IGFmdGVyQ3VycmVudERhdGU6IHRydWUgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZhbGlkYXRlIElQXHJcbiAgICogQHBhcmFtIGNvbnRyb2wgOiBhbnlcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGlzSXAoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogYW55IHtcclxuICAgIGlmICghY29udHJvbC52YWx1ZSkgeyByZXR1cm47IH1cclxuICAgIGNvbnN0IHN0cjogc3RyaW5nID0gJ14oKFswLTldfFsxLTldWzAtOV18MVswLTldezJ9fDJbMC00XVswLTldfDI1WzAtNV0pXFwuJ1xyXG4gICAgICArICcpezN9KFswLTldfFsxLTldWzAtOV18MVswLTldezJ9fDJbMC00XVswLTldfDI1WzAtNV0pJCc7XHJcbiAgICBjb25zdCByZWdFeHAgPSBuZXcgUmVnRXhwKHN0cik7XHJcbiAgICBpZiAoIXJlZ0V4cC50ZXN0KGNvbnRyb2wudmFsdWUpKSB7XHJcbiAgICAgIHJldHVybiB7IGlzSXA6IHRydWUgfTtcclxuICAgIH1cclxuICAgIHJldHVybiAnJztcclxuICB9XHJcbiAgLyoqXHJcbiAqIFZhbGlkYXRlIFVSTFxyXG4gKiBAcGFyYW0gY29udHJvbCA6IGFueVxyXG4gKi9cclxuICBwdWJsaWMgc3RhdGljIGlzVXJsKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IGFueSB7XHJcbiAgICBpZiAoIWNvbnRyb2wudmFsdWUpIHsgcmV0dXJuOyB9XHJcbiAgICBjb25zdCBzdHIgPSAnKGh0dHBzPzpcXC9cXC8oPzp3d3dcXC58KD8hd3d3KSlbYS16QS1aMC05XVthLXpBLVowLTktXStbYS16QS1aMC05XVxcLlteXFxzXXsyLH18JyArXHJcbiAgICAgICd3d3dcXC5bYS16QS1aMC05XVthLXpBLVowLTktXStbYS16QS1aMC05XVxcLlteXFxzXXsyLH18JyArXHJcbiAgICAgICdodHRwcz86XFwvXFwvKD86d3d3XFwufCg/IXd3dykpW2EtekEtWjAtOV1cXC5bXlxcc117Mix9fHd3d1xcLlthLXpBLVowLTldXFwuW15cXHNdezIsfSknO1xyXG4gICAgY29uc3QgcmVnRXhwID0gbmV3IFJlZ0V4cChzdHIpO1xyXG4gICAgaWYgKCFyZWdFeHAudGVzdChjb250cm9sLnZhbHVlKSkge1xyXG4gICAgICByZXR1cm4geyBpc1VybDogdHJ1ZSB9O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIH1cclxuXHJcbiAgLyoqIFZhbGlkYXRlIGVtYWlsIGZvcm1hdCAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZW1haWxGb3JtYXQoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogYW55IHtcclxuICAgIGlmICghY29udHJvbC52YWx1ZSkgeyByZXR1cm47IH1cclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbWF4LWxpbmUtbGVuZ3RoXHJcbiAgICByZXR1cm4gKGNvbnRyb2wudmFsdWUudG9TdHJpbmcoKS50cmltKCkubWF0Y2goL14oKChbYS16XXxcXGR8WyEjXFwkJSYnXFwqXFwrXFwtXFwvPVxcP1xcXl9ge1xcfH1+XXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkrKFxcLihbYS16XXxcXGR8WyEjXFwkJSYnXFwqXFwrXFwtXFwvPVxcP1xcXl9ge1xcfH1+XXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkrKSopfCgoXFx4MjIpKCgoKFxceDIwfFxceDA5KSooXFx4MGRcXHgwYSkpPyhcXHgyMHxcXHgwOSkrKT8oKFtcXHgwMS1cXHgwOFxceDBiXFx4MGNcXHgwZS1cXHgxZlxceDdmXXxcXHgyMXxbXFx4MjMtXFx4NWJdfFtcXHg1ZC1cXHg3ZV18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pfChcXFxcKFtcXHgwMS1cXHgwOVxceDBiXFx4MGNcXHgwZC1cXHg3Zl18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKSkpKigoKFxceDIwfFxceDA5KSooXFx4MGRcXHgwYSkpPyhcXHgyMHxcXHgwOSkrKT8oXFx4MjIpKSlAKCgoW2Etel18XFxkfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKXwoKFthLXpdfFxcZHxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkoW2Etel18XFxkfC18XFwufF98fnxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkqKFthLXpdfFxcZHxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkpKVxcLikrKChbYS16XXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSl8KChbYS16XXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkoW2Etel18XFxkfC18XFwufF98fnxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkqKFthLXpdfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKSkpXFwuPyQvaSkpXHJcbiAgICAgID8gJycgOiB7IGludmFsaWRFbWFpbDogdHJ1ZSB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVmFsaWRhdGUgZGF0ZSBub3QgYWZmdGVyIGRhdGVcclxuICAgKiBAcGFyYW0gdGFyZ2V0S2V5OiBhbnlcclxuICAgKiBAcGFyYW0gdG9NYXRjaEtleTogYW55XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBub3RBZmZ0ZXIodGFyZ2V0S2V5OiBzdHJpbmcsIHRvTWF0Y2hLZXk6IHN0cmluZywgbGFiZWxNYXRjaENvZGU6IHN0cmluZyk6IFZhbGlkYXRvckZuIHwgYW55e1xyXG4gICAgcmV0dXJuIChncm91cDogRm9ybUdyb3VwKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB8IG51bGwgPT4ge1xyXG4gICAgICBjb25zdCB0YXJnZXQgPSBncm91cC5jb250cm9sc1t0YXJnZXRLZXldO1xyXG4gICAgICBjb25zdCB0b01hdGNoID0gZ3JvdXAuY29udHJvbHNbdG9NYXRjaEtleV07XHJcbiAgICAgIGlmICh0YXJnZXQuaGFzRXJyb3IoJ2RhdGVOb3RBZmZ0ZXInKSkge1xyXG4gICAgICAgIHRhcmdldC5zZXRFcnJvcnMobnVsbCk7XHJcbiAgICAgICAgdGFyZ2V0Lm1hcmtBc1VudG91Y2hlZCgpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodGFyZ2V0LnZhbHVlICYmIHRvTWF0Y2gudmFsdWUpIHtcclxuICAgICAgICBjb25zdCBpc0NoZWNrID0gdGFyZ2V0LnZhbHVlIDw9IHRvTWF0Y2gudmFsdWU7XHJcbiAgICAgICAgLy8gc2V0IGVxdWFsIHZhbHVlIGVycm9yIG9uIGRpcnR5IGNvbnRyb2xzXHJcbiAgICAgICAgaWYgKCFpc0NoZWNrICYmIHRhcmdldC52YWxpZCAmJiB0b01hdGNoLnZhbGlkKSB7XHJcbiAgICAgICAgICB0YXJnZXQuc2V0RXJyb3JzKHsgZGF0ZU5vdEFmZnRlcjogeyBkYXRlTm90QWZmdGVyOiBsYWJlbE1hdGNoQ29kZSB9IH0pO1xyXG4gICAgICAgICAgdGFyZ2V0Lm1hcmtBc1RvdWNoZWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBWYWxpZGF0ZSBkYXRlIG5vdCBiZWZvcmUgZGF0ZVxyXG4gICogQHBhcmFtIHRhcmdldEtleTogYW55XHJcbiAgKiBAcGFyYW0gdG9NYXRjaEtleTogYW55XHJcbiAgKi9cclxuICBwdWJsaWMgc3RhdGljIG5vdEJlZm9yZSh0YXJnZXRLZXk6IHN0cmluZywgdG9NYXRjaEtleTogc3RyaW5nLCBsYWJlbE1hdGNoQ29kZTogc3RyaW5nKTogVmFsaWRhdG9yRm4gfCBhbnl7XHJcbiAgICByZXR1cm4gKGdyb3VwOiBGb3JtR3JvdXApOiB7IFtrZXk6IHN0cmluZ106IGFueSB9IHwgbnVsbCA9PiB7XHJcbiAgICAgIGNvbnN0IHRhcmdldCA9IGdyb3VwLmNvbnRyb2xzW3RhcmdldEtleV07XHJcbiAgICAgIGNvbnN0IHRvTWF0Y2ggPSBncm91cC5jb250cm9sc1t0b01hdGNoS2V5XTtcclxuICAgICAgaWYgKHRhcmdldC5oYXNFcnJvcignZGF0ZU5vdEJlZm9yZScpKSB7XHJcbiAgICAgICAgdGFyZ2V0LnNldEVycm9ycyhudWxsKTtcclxuICAgICAgICB0YXJnZXQubWFya0FzVW50b3VjaGVkKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0YXJnZXQudmFsdWUgJiYgdG9NYXRjaC52YWx1ZSkge1xyXG4gICAgICAgIGNvbnN0IGlzQ2hlY2sgPSB0YXJnZXQudmFsdWUgPj0gdG9NYXRjaC52YWx1ZTtcclxuICAgICAgICAvLyBzZXQgZXF1YWwgdmFsdWUgZXJyb3Igb24gZGlydHkgY29udHJvbHNcclxuICAgICAgICBpZiAoIWlzQ2hlY2sgJiYgdGFyZ2V0LnZhbGlkICYmIHRvTWF0Y2gudmFsaWQpIHtcclxuICAgICAgICAgIHRhcmdldC5zZXRFcnJvcnMoeyBkYXRlTm90QmVmb3JlOiB7IGRhdGVOb3RCZWZvcmU6IGxhYmVsTWF0Y2hDb2RlIH0gfSk7XHJcbiAgICAgICAgICB0YXJnZXQubWFya0FzVG91Y2hlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFZhbGlkYXRlIGRhdGUgbm90IGFmZnRlciBudW1iZXJcclxuICAgKiBAcGFyYW0gdGFyZ2V0S2V5OiBhbnlcclxuICAgKiBAcGFyYW0gdG9NYXRjaEtleTogYW55XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBub3RBZmZ0ZXJOdW1iZXIodGFyZ2V0S2V5OiBzdHJpbmcsIHRvTWF0Y2hLZXk6IHN0cmluZywgbGFiZWxNYXRjaENvZGU6IHN0cmluZyk6IFZhbGlkYXRvckZuIHwgYW55e1xyXG4gICAgcmV0dXJuIChncm91cDogRm9ybUdyb3VwKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB8IG51bGwgPT4ge1xyXG4gICAgICBjb25zdCB0YXJnZXQgPSBncm91cC5jb250cm9sc1t0YXJnZXRLZXldO1xyXG4gICAgICBjb25zdCB0b01hdGNoID0gZ3JvdXAuY29udHJvbHNbdG9NYXRjaEtleV07XHJcbiAgICAgIC8vIG5ldSBtb3QgdHJvbmcgaGFpIHRydW9uZyBudWxsIHRoaSBjaHV5ZW4gc2FuZyByZXF1aXJlXHJcbiAgICAgIGlmICghdGFyZ2V0IHx8ICF0b01hdGNoKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH1cclxuICAgICAgLy8gZGlldSBraWVuIGtpZW0gdHJhXHJcbiAgICAgIGlmICh0YXJnZXQuaGFzRXJyb3IoJ2RhdGVOb3RBZmZ0ZXInKSkge1xyXG4gICAgICAgIHRhcmdldC5zZXRFcnJvcnMobnVsbCk7XHJcbiAgICAgICAgdGFyZ2V0Lm1hcmtBc1VudG91Y2hlZCgpO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IHRhcmdldFZhbHVlID0gcGFyc2VGbG9hdCh0YXJnZXQudmFsdWUpO1xyXG4gICAgICBjb25zdCB0b01hdGNoVmFsdWUgPSBwYXJzZUZsb2F0KHRvTWF0Y2gudmFsdWUpO1xyXG4gICAgICBpZiAodGFyZ2V0VmFsdWUgJiYgdG9NYXRjaFZhbHVlKSB7XHJcbiAgICAgICAgY29uc3QgaXNDaGVjayA9IHRhcmdldFZhbHVlIDw9IHRvTWF0Y2hWYWx1ZTtcclxuICAgICAgICAvLyBzZXQgZXF1YWwgdmFsdWUgZXJyb3Igb24gZGlydHkgY29udHJvbHNcclxuICAgICAgICBpZiAoIWlzQ2hlY2sgJiYgdGFyZ2V0LnZhbGlkICYmIHRvTWF0Y2gudmFsaWQpIHtcclxuICAgICAgICAgIHRhcmdldC5zZXRFcnJvcnMoeyBkYXRlTm90QWZmdGVyOiB7IGRhdGVOb3RBZmZ0ZXI6IGxhYmVsTWF0Y2hDb2RlIH0gfSk7XHJcbiAgICAgICAgICB0YXJnZXQubWFya0FzVG91Y2hlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSBkYXRlIGluIHJhbmdlIDYgTW9udGhcclxuICAgKiBAcGFyYW0gdGFyZ2V0S2V5OiBhbnlcclxuICAgKiBAcGFyYW0gdG9NYXRjaEtleTogYW55XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBpc1JhbmdlT2Y2TW9udGgodGFyZ2V0S2V5OiBzdHJpbmcsIHRvTWF0Y2hLZXk6IHN0cmluZywgbGFiZWxNYXRjaENvZGU6IHN0cmluZyk6IFZhbGlkYXRvckZuIHwgYW55e1xyXG4gICAgcmV0dXJuIChncm91cDogRm9ybUdyb3VwKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB8IG51bGwgPT4ge1xyXG4gICAgICBjb25zdCB0YXJnZXQgPSBncm91cC5jb250cm9sc1t0YXJnZXRLZXldO1xyXG4gICAgICBjb25zdCB0b01hdGNoID0gZ3JvdXAuY29udHJvbHNbdG9NYXRjaEtleV07XHJcbiAgICAgIC8vIGtpZW0gdHJhIG51bGxcclxuICAgICAgaWYgKHRhcmdldC5oYXNFcnJvcignaXNSYW5nZU9mNk1vbnRoJykpIHtcclxuICAgICAgICB0YXJnZXQuc2V0RXJyb3JzKG51bGwpO1xyXG4gICAgICAgIHRhcmdldC5tYXJrQXNVbnRvdWNoZWQoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IHRlbXAgPSBuZXcgRGF0ZSh0YXJnZXQudmFsdWUpO1xyXG4gICAgICB0ZW1wLnNldE1vbnRoKHRlbXAuZ2V0TW9udGgoKSArIDYpO1xyXG5cclxuXHJcbiAgICAgIC8vIGtpZW0gdHJhICBnaWEgdHJpXHJcbiAgICAgIGlmICh0YXJnZXQudmFsdWUgJiYgdG9NYXRjaC52YWx1ZSkge1xyXG4gICAgICAgIGNvbnN0IGlzQ2hlY2sgPSB0ZW1wID49IG5ldyBEYXRlKHRvTWF0Y2gudmFsdWUpO1xyXG4gICAgICAgIC8vIHNldCBlcXVhbCB2YWx1ZSBlcnJvciBvbiBkaXJ0eSBjb250cm9sc1xyXG4gICAgICAgIGlmICghaXNDaGVjaykge1xyXG4gICAgICAgICAgdGFyZ2V0LnNldEVycm9ycyh7IGlzUmFuZ2VPZjZNb250aDogeyBkYXRlTm90QWZmdGVyOiBsYWJlbE1hdGNoQ29kZSB9IH0pO1xyXG4gICAgICAgICAgdGFyZ2V0Lm1hcmtBc1RvdWNoZWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVmFsaWRhdGUgZGF0ZSBub3QgYmVmb3JlIGEgc3BlY2lmeSBkYXRlXHJcbiAgICogQHBhcmFtIHRhcmdldEtleTogYW55XHJcbiAgICogQHBhcmFtIHNwZWNpZnlEYXRlOiBhbnlcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGJlZm9yZVNwZWNpZnlEYXRlKHRhcmdldEtleTogc3RyaW5nLCBzcGVjaWZ5RGF0ZTogc3RyaW5nLCBsYWJlbE1hdGNoQ29kZTogc3RyaW5nKTogVmFsaWRhdG9yRm4gfCBhbnl7XHJcbiAgICByZXR1cm4gKGdyb3VwOiBGb3JtR3JvdXApOiB7IFtrZXk6IHN0cmluZ106IGFueSB9IHwgbnVsbCA9PiB7XHJcbiAgICAgIGNvbnN0IHRhcmdldCA9IGdyb3VwLmNvbnRyb2xzW3RhcmdldEtleV07XHJcblxyXG4gICAgICAvLyBOZXUgbW90IHRyb25nIGhhaSB0cnVvbmcgbnVsbFxyXG4gICAgICBpZiAoIXRhcmdldCB8fCAhc3BlY2lmeURhdGUpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gRGlldSBraWVuIGtpZW0gdHJhXHJcbiAgICAgIGlmICh0YXJnZXQuaGFzRXJyb3IoJ2RhdGVOb3RCZWZvcmUnKSkge1xyXG4gICAgICAgIHRhcmdldC5zZXRFcnJvcnMobnVsbCk7XHJcbiAgICAgICAgdGFyZ2V0Lm1hcmtBc1VudG91Y2hlZCgpO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IHRhcmdldFZhbHVlID0gcGFyc2VGbG9hdCh0YXJnZXQudmFsdWUpO1xyXG4gICAgICBjb25zdCB0b01hdGNoVmFsdWUgPSBwYXJzZUZsb2F0KHNwZWNpZnlEYXRlKTtcclxuICAgICAgaWYgKHRhcmdldFZhbHVlIHx8IHRhcmdldFZhbHVlID09PSAwICYmIHRvTWF0Y2hWYWx1ZSkge1xyXG4gICAgICAgIGNvbnN0IGlzQ2hlY2sgPSB0YXJnZXRWYWx1ZSA+PSB0b01hdGNoVmFsdWU7XHJcbiAgICAgICAgLy8gU2V0IGVxdWFsIHZhbHVlIGVycm9yIG9uIGRpcnR5IGNvbnRyb2xzXHJcbiAgICAgICAgaWYgKCFpc0NoZWNrICYmIHRhcmdldC52YWxpZCkge1xyXG4gICAgICAgICAgdGFyZ2V0LnNldEVycm9ycyh7IGRhdGVOb3RCZWZvcmU6IHsgZGF0ZU5vdEJlZm9yZTogbGFiZWxNYXRjaENvZGUgfSB9KTtcclxuICAgICAgICAgIHRhcmdldC5tYXJrQXNUb3VjaGVkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZhbGlkYXRlIGRhdGUgbm90IGFmdGVyIGEgc3BlY2lmeSBkYXRlXHJcbiAgICogQHBhcmFtIHRhcmdldEtleTogYW55XHJcbiAgICogQHBhcmFtIHNwZWNpZnlEYXRlOiBhbnlcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGFmdGVyU3BlY2lmeURhdGUodGFyZ2V0S2V5OiBzdHJpbmcsIHNwZWNpZnlEYXRlOiBzdHJpbmcsIGxhYmVsTWF0Y2hDb2RlOiBzdHJpbmcpOiBWYWxpZGF0b3JGbiB8IGFueXtcclxuICAgIHJldHVybiAoZ3JvdXA6IEZvcm1Hcm91cCk6IHsgW2tleTogc3RyaW5nXTogYW55IH0gfCBudWxsID0+IHtcclxuICAgICAgY29uc3QgdGFyZ2V0ID0gZ3JvdXAuY29udHJvbHNbdGFyZ2V0S2V5XTtcclxuXHJcbiAgICAgIC8vIE5ldSBtb3QgdHJvbmcgaGFpIHRydW9uZyBudWxsXHJcbiAgICAgIGlmICghdGFyZ2V0IHx8ICFzcGVjaWZ5RGF0ZSkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBEaWV1IGtpZW4ga2llbSB0cmFcclxuICAgICAgaWYgKHRhcmdldC5oYXNFcnJvcignZGF0ZU5vdEFmZnRlcicpKSB7XHJcbiAgICAgICAgdGFyZ2V0LnNldEVycm9ycyhudWxsKTtcclxuICAgICAgICB0YXJnZXQubWFya0FzVW50b3VjaGVkKCk7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgdGFyZ2V0VmFsdWUgPSBwYXJzZUZsb2F0KHRhcmdldC52YWx1ZSk7XHJcbiAgICAgIGNvbnN0IHRvTWF0Y2hWYWx1ZSA9IHBhcnNlRmxvYXQoc3BlY2lmeURhdGUpO1xyXG4gICAgICBpZiAodGFyZ2V0VmFsdWUgfHwgdGFyZ2V0VmFsdWUgPT09IDAgJiYgdG9NYXRjaFZhbHVlKSB7XHJcbiAgICAgICAgY29uc3QgaXNDaGVjayA9IHRhcmdldFZhbHVlIDw9IHRvTWF0Y2hWYWx1ZTtcclxuICAgICAgICAvLyBTZXQgZXF1YWwgdmFsdWUgZXJyb3Igb24gZGlydHkgY29udHJvbHNcclxuICAgICAgICBpZiAoIWlzQ2hlY2sgJiYgdGFyZ2V0LnZhbGlkKSB7XHJcbiAgICAgICAgICB0YXJnZXQuc2V0RXJyb3JzKHsgZGF0ZU5vdEFmZnRlcjogeyBkYXRlTm90QWZmdGVyOiBsYWJlbE1hdGNoQ29kZSB9IH0pO1xyXG4gICAgICAgICAgdGFyZ2V0Lm1hcmtBc1RvdWNoZWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVmFsaWRhdGUgZGF0ZSBub3QgYmVmb3JlIG51bWJlclxyXG4gICAqIEBwYXJhbSB0YXJnZXRLZXk6IGFueVxyXG4gICAqIEBwYXJhbSB0b01hdGNoS2V5OiBhbnlcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG5vdEJlZm9yZU51bWJlcih0YXJnZXRLZXk6IHN0cmluZywgdG9NYXRjaEtleTogc3RyaW5nLCBsYWJlbE1hdGNoQ29kZTogc3RyaW5nKTogVmFsaWRhdG9yRm4gfCBhbnl7XHJcbiAgICByZXR1cm4gKGdyb3VwOiBGb3JtR3JvdXApOiB7IFtrZXk6IHN0cmluZ106IGFueSB9IHwgbnVsbCA9PiB7XHJcbiAgICAgIGNvbnN0IHRhcmdldCA9IGdyb3VwLmNvbnRyb2xzW3RhcmdldEtleV07XHJcbiAgICAgIGNvbnN0IHRvTWF0Y2ggPSBncm91cC5jb250cm9sc1t0b01hdGNoS2V5XTtcclxuICAgICAgLy8gbmV1IG1vdCB0cm9uZyBoYWkgdHJ1b25nIG51bGwgdGhpIGNodXllbiBzYW5nIHJlcXVpcmVcclxuICAgICAgaWYgKCF0YXJnZXQgfHwgIXRvTWF0Y2gpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICAvLyBkaWV1IGtpZW4ga2llbSB0cmFcclxuICAgICAgaWYgKHRhcmdldC5oYXNFcnJvcignZGF0ZU5vdEJlZm9yZScpKSB7XHJcbiAgICAgICAgdGFyZ2V0LnNldEVycm9ycyhudWxsKTtcclxuICAgICAgICB0YXJnZXQubWFya0FzVW50b3VjaGVkKCk7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgdGFyZ2V0VmFsdWUgPSBwYXJzZUZsb2F0KHRhcmdldC52YWx1ZSk7XHJcbiAgICAgIGNvbnN0IHRvTWF0Y2hWYWx1ZSA9IHBhcnNlRmxvYXQodG9NYXRjaC52YWx1ZSk7XHJcbiAgICAgIGlmICh0YXJnZXRWYWx1ZSB8fCB0YXJnZXRWYWx1ZSA9PT0gMCAmJiB0b01hdGNoVmFsdWUpIHtcclxuICAgICAgICBjb25zdCBpc0NoZWNrID0gdGFyZ2V0VmFsdWUgPj0gdG9NYXRjaFZhbHVlO1xyXG4gICAgICAgIC8vIHNldCBlcXVhbCB2YWx1ZSBlcnJvciBvbiBkaXJ0eSBjb250cm9sc1xyXG4gICAgICAgIGlmICghaXNDaGVjayAmJiB0YXJnZXQudmFsaWQgJiYgdG9NYXRjaC52YWxpZCkge1xyXG4gICAgICAgICAgdGFyZ2V0LnNldEVycm9ycyh7IGRhdGVOb3RCZWZvcmU6IHsgZGF0ZU5vdEJlZm9yZTogbGFiZWxNYXRjaENvZGUgfSB9KTtcclxuICAgICAgICAgIHRhcmdldC5tYXJrQXNUb3VjaGVkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICB9XHJcbiAgcHVibGljIHN0YXRpYyBnZXRWYWxpZGF0b3JBcnIob2xkQXJyOiBBcnJheTxWYWxpZGF0b3JGbj4sIHByb3A/OiBTeXNQcm9wZXJ0eURldGFpbEJlYW4pOiBBcnJheTxWYWxpZGF0b3JGbj4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9ycyA9IG5ldyBBcnJheTxWYWxpZGF0b3JGbj4oKTtcclxuICAgIGlmIChvbGRBcnIgJiYgb2xkQXJyLmxlbmd0aCA+IDAgJiYgKHByb3AgPT09IG51bGwgfHwgcHJvcCA9PT0gdW5kZWZpbmVkKSkge1xyXG4gICAgICByZXR1cm4gb2xkQXJyO1xyXG4gICAgfVxyXG4gICAgaWYgKHByb3AgPT09IG51bGwgfHwgcHJvcCA9PT0gdW5kZWZpbmVkIHx8IHByb3AuaXNIaWRlID09PSB0cnVlKSB7XHJcbiAgICAgIHJldHVybiB2YWxpZGF0b3JzO1xyXG4gICAgfVxyXG4gICAgaWYgKHByb3AuaXNSZXF1aXJlKSB7XHJcbiAgICAgIHZhbGlkYXRvcnMucHVzaChWYWxpZGF0aW9uU2VydmljZS5yZXF1aXJlZCk7XHJcbiAgICB9XHJcbiAgICBpZiAocHJvcC5pc0VtYWlsKSB7XHJcbiAgICAgIHZhbGlkYXRvcnMucHVzaChWYWxpZGF0b3JzLmVtYWlsKTtcclxuICAgIH1cclxuICAgIGlmIChwcm9wLmlzTnVtYmVyKSB7XHJcbiAgICAgIHZhbGlkYXRvcnMucHVzaChWYWxpZGF0aW9uU2VydmljZS5udW1iZXIpO1xyXG4gICAgfVxyXG4gICAgaWYgKHByb3AuaXNVcmwpIHtcclxuICAgICAgdmFsaWRhdG9ycy5wdXNoKFZhbGlkYXRpb25TZXJ2aWNlLmlzVXJsKTtcclxuICAgIH1cclxuICAgIGlmIChwcm9wLmlzSXApIHtcclxuICAgICAgdmFsaWRhdG9ycy5wdXNoKFZhbGlkYXRpb25TZXJ2aWNlLmlzSXApO1xyXG4gICAgfVxyXG4gICAgaWYgKHByb3AubWluTGVuZ3RoKSB7XHJcbiAgICAgIHZhbGlkYXRvcnMucHVzaChWYWxpZGF0b3JzLm1pbkxlbmd0aChwcm9wLm1pbkxlbmd0aCkpO1xyXG4gICAgfVxyXG4gICAgaWYgKHByb3AubWF4TGVuZ3RoKSB7XHJcbiAgICAgIHZhbGlkYXRvcnMucHVzaChWYWxpZGF0aW9uU2VydmljZS5tYXhMZW5ndGgocHJvcC5tYXhMZW5ndGgpKTtcclxuICAgIH1cclxuICAgIGlmIChwcm9wLm51bWJlck1pbikge1xyXG4gICAgICB2YWxpZGF0b3JzLnB1c2goVmFsaWRhdG9ycy5taW4ocHJvcC5udW1iZXJNaW4pKTtcclxuICAgIH1cclxuICAgIGlmIChwcm9wLm51bWJlck1heCkge1xyXG4gICAgICB2YWxpZGF0b3JzLnB1c2goVmFsaWRhdG9ycy5tYXgocHJvcC5udW1iZXJNYXgpKTtcclxuICAgIH1cclxuICAgIGlmIChwcm9wLnBhc3N3b3JkKSB7XHJcbiAgICAgIHZhbGlkYXRvcnMucHVzaChWYWxpZGF0aW9uU2VydmljZS5wYXNzd29yZFZhbGlkYXRvcik7XHJcbiAgICB9XHJcbiAgICBpZiAocHJvcC5waG9uZSkge1xyXG4gICAgICB2YWxpZGF0b3JzLnB1c2goVmFsaWRhdGlvblNlcnZpY2UucGhvbmUpO1xyXG4gICAgfVxyXG4gICAgaWYgKHByb3AubW9iaWxlTnVtYmVyKSB7XHJcbiAgICAgIHZhbGlkYXRvcnMucHVzaChWYWxpZGF0aW9uU2VydmljZS5tb2JpbGVOdW1iZXIpO1xyXG4gICAgfVxyXG4gICAgaWYgKHByb3AucGVyc29uYWxJZE51bWJlcikge1xyXG4gICAgICB2YWxpZGF0b3JzLnB1c2goVmFsaWRhdGlvblNlcnZpY2UucGVyc29uYWxJZE51bWJlcik7XHJcbiAgICB9XHJcbiAgICBpZiAocHJvcC5iZWZvcmVDdXJyZW50RGF0ZSkge1xyXG4gICAgICB2YWxpZGF0b3JzLnB1c2goVmFsaWRhdGlvblNlcnZpY2UuYmVmb3JlQ3VycmVudERhdGUpO1xyXG4gICAgfVxyXG4gICAgaWYgKHByb3AubnVtYmVyVHlwZSkge1xyXG4gICAgICBzd2l0Y2ggKHByb3AubnVtYmVyVHlwZSkge1xyXG4gICAgICAgIGNhc2UgJ2lzTnVtYmVyJzpcclxuICAgICAgICAgIHZhbGlkYXRvcnMucHVzaChWYWxpZGF0aW9uU2VydmljZS5udW1iZXIpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncG9zaXRpdmVOdW1iZXInOlxyXG4gICAgICAgICAgdmFsaWRhdG9ycy5wdXNoKFZhbGlkYXRpb25TZXJ2aWNlLnBvc2l0aXZlTnVtYmVyKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2ludGVnZXInOlxyXG4gICAgICAgICAgdmFsaWRhdG9ycy5wdXNoKFZhbGlkYXRpb25TZXJ2aWNlLmludGVnZXIpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncG9zaXRpdmVJbnRlZ2VyJzpcclxuICAgICAgICAgIHZhbGlkYXRvcnMucHVzaChWYWxpZGF0aW9uU2VydmljZS5wb3NpdGl2ZUludGVnZXIpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncG9zaXRpdmVSZWFsTnVtYmVyJzpcclxuICAgICAgICAgIHZhbGlkYXRvcnMucHVzaChWYWxpZGF0aW9uU2VydmljZS5wb3NpdGl2ZVJlYWxOdW1iZXIpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChwcm9wLmVtYWlsRm9ybWF0KSB7XHJcbiAgICAgIHZhbGlkYXRvcnMucHVzaChWYWxpZGF0aW9uU2VydmljZS5lbWFpbEZvcm1hdCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdmFsaWRhdG9ycztcclxuICB9XHJcbiAgLyoqXHJcbiAgICAgKiBWYWxpZGF0ZSAnxJDGoW4gduG7iywgQ2jhu6ljIGRhbmggY8O0bmcgdmnhu4djIGtow7RuZyDEkcaw4bujYyBwaMOpcCB0csO5bmcnXHJcbiAgICAgKiBAcGFyYW0gdGFyZ2V0S2V5OiBhbnlcclxuICAgICAqIEBwYXJhbSB0b01hdGNoS2V5OiBhbnlcclxuICAgICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZHVwbGljYXRlQXJyYXkoY29udHJvbEtleXM6IEFycmF5PHN0cmluZz4sIHRhcmdldDogc3RyaW5nLCBtZXNzYWdlS2V5Pzogc3RyaW5nKTogVmFsaWRhdG9yRm4gfCBhbnl7XHJcbiAgICByZXR1cm4gKGFycmF5OiBGb3JtQXJyYXkpID0+IHtcclxuICAgICAgLy8gdGFyZ2V0LnNldEVycm9ycyh7ZHVwbGljYXRlQXJyYXk6IHtkdXBsaWNhdGVOYW1lOiBtZXNzYWdlS2V5fX0pO1xyXG4gICAgICAvLyB0YXJnZXQubWFya0FzVG91Y2hlZCgpO1xyXG4gICAgICBjb25zdCBtYXA6IG9iamVjdCA9IHt9O1xyXG4gICAgICBmb3IgKGNvbnN0IGdyb3VwIG9mIGFycmF5LmNvbnRyb2xzKSB7XHJcbiAgICAgICAgY29uc3QgY29udHJvbFRhZ2V0ID0gZ3JvdXAuZ2V0KHRhcmdldCkgYXMgRm9ybUNvbnRyb2w7XHJcbiAgICAgICAgbGV0IGNvdW50ID0gMDtcclxuICAgICAgICBjb25zdCB2YWx1ZXMgPSBbXTtcclxuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBjb250cm9sS2V5cykge1xyXG4gICAgICAgICAgY29uc3QgY29udHJvbCA9IGdyb3VwLmdldChrZXkpIGFzIEZvcm1Db250cm9sO1xyXG4gICAgICAgICAgaWYgKGNvbnRyb2wudmFsdWUgIT09IG51bGwgJiYgY29udHJvbC52YWx1ZSAhPT0gJycpIHtcclxuICAgICAgICAgICAgdmFsdWVzLnB1c2goY29udHJvbC52YWx1ZSk7XHJcbiAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBrID0gJy8nICsgdmFsdWVzLmpvaW4oJy8nKSArICcvJztcclxuICAgICAgICBrID0gay50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChjb250cm9sS2V5cy5sZW5ndGggPT09IGNvdW50KSB7XHJcbiAgICAgICAgICBpZiAobWFwLmhhc093blByb3BlcnR5KGspKSB7XHJcbiAgICAgICAgICAgIGNvbnRyb2xUYWdldC5zZXRFcnJvcnMoeyBkdXBsaWNhdGVBcnJheTogeyBkdXBsaWNhdGVBcnJheTogbWVzc2FnZUtleSB9IH0pO1xyXG4gICAgICAgICAgICBjb250cm9sVGFnZXQubWFya0FzVG91Y2hlZCgpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgKG1hcCBhcyBhbnkpW2tdID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gZml4IGJ1ZyBraGkgeG9hIHJvdyBkYXUga2hpIGJpIGR1cGxpY2F0ZVxyXG4gICAgICAgICAgICBpZiAoY29udHJvbFRhZ2V0Lmhhc0Vycm9yKCdkdXBsaWNhdGVBcnJheScpKSB7XHJcbiAgICAgICAgICAgICAgY29udHJvbFRhZ2V0LnNldEVycm9ycyhudWxsKTtcclxuICAgICAgICAgICAgICBjb250cm9sVGFnZXQubWFya0FzVW50b3VjaGVkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gIH1cclxuICAvLyBIw6BtIHjhu60gbMO9IHZhbGlkYXRlIGLhuq90IGJ14buZYyBuaOG6rXAgY8OhYyB0csaw4budbmcgY8OybiBs4bqhaSBu4bq/dSBjw7MgMSB0csaw4budbmcgdHJvbmcgZGFuaCBzw6FjaCDEkcaw4bujYyBuaOG6rXBcclxuICBwdWJsaWMgc3RhdGljIHJlcXVpcmVkSWZIYXZlT25lKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IGFueSB7XHJcbiAgICBsZXQgaXNSZXF1aXJlID0gZmFsc2U7XHJcbiAgICBjb25zdCBncm91cCA9IGNvbnRyb2wucGFyZW50IGFzIEZvcm1Hcm91cDtcclxuICAgIE9iamVjdC5rZXlzKGdyb3VwLmNvbnRyb2xzKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgIGNvbnN0IGNvbnRyb2xFbCA9IGdyb3VwLmdldChrZXkpIGFzIEJhc2VDb250cm9sO1xyXG4gICAgICBpZiAoY29udHJvbEVsLnByb3BlcnR5TmFtZSAhPT0gKGNvbnRyb2wgYXMgQmFzZUNvbnRyb2wpLnByb3BlcnR5TmFtZSkge1xyXG4gICAgICAgIGlmIChjb250cm9sRWwubGlzdFZhbGlkYXRpb24pIHtcclxuICAgICAgICAgIGZvciAoY29uc3QgZiBvZiBjb250cm9sRWwubGlzdFZhbGlkYXRpb24pIHtcclxuICAgICAgICAgICAgY29uc3QgZm4gPSBmIGFzIFZhbGlkYXRvckZuO1xyXG4gICAgICAgICAgICBpZiAoZm4gPT09IFZhbGlkYXRpb25TZXJ2aWNlLnJlcXVpcmVkSWZIYXZlT25lICYmIGNvbnRyb2xFbC52YWx1ZSkge1xyXG4gICAgICAgICAgICAgIGlzUmVxdWlyZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgaWYgKGlzUmVxdWlyZSAmJiAhY29udHJvbC52YWx1ZSkge1xyXG4gICAgICByZXR1cm4geyByZXF1aXJlZElmSGF2ZU9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBYdSBseSBuZXUgbmh1IGNvIGdpYSB0cmkgdGFpIHRydW9uZyBoaWVuIHRhaSB0aGkgdmFsaWRhdGUgYmF0IGJ1b2MgbmhhcCB0YWkgdHJ1b25nIGR1b2Mgc2V0XHJcbiAgICogQHBhcmFtIGNvbnRyb2xLZXlzIFRlbiB0cnVvbmcgYmF0IGJ1b2MgbmhhcFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgaWZIYXZlT25lSXNSZXF1aXJlZChjb250cm9sS2V5czogc3RyaW5nKTogVmFsaWRhdG9yRm4gfCBhbnl7XHJcbiAgICByZXR1cm4gKGM6IEFic3RyYWN0Q29udHJvbCk6IGFueSB8IG51bGwgPT4ge1xyXG4gICAgICBjb25zdCBncm91cCA9IGMucGFyZW50IGFzIEZvcm1Hcm91cDtcclxuICAgICAgY29uc3QgY29udHJvbFJlcXVpcmVkID0gZ3JvdXAuZ2V0KGNvbnRyb2xLZXlzKSBhcyBGb3JtQ29udHJvbDtcclxuICAgICAgaWYgKGMudmFsdWUgIT09IG51bGwgJiYgYy52YWx1ZS50b1N0cmluZygpLmxlbmd0aCA+IDApIHsgLy8gIHZpIGNvIHRoIHZhbHVlID0gW11cclxuICAgICAgICBpZiAoY29udHJvbFJlcXVpcmVkLnZhbHVlID09PSBudWxsIHx8IGNvbnRyb2xSZXF1aXJlZC52YWx1ZSA9PT0gJycpIHtcclxuICAgICAgICAgIGNvbnRyb2xSZXF1aXJlZC5zZXRFcnJvcnMoeyBpZkhhdmVPbmVJc1JlcXVpcmVkOiB0cnVlIH0pO1xyXG4gICAgICAgICAgY29udHJvbFJlcXVpcmVkLm1hcmtBc1RvdWNoZWQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKGNvbnRyb2xSZXF1aXJlZC5oYXNFcnJvcignaWZIYXZlT25lSXNSZXF1aXJlZCcpKSB7XHJcbiAgICAgICAgICAgIGNvbnRyb2xSZXF1aXJlZC5zZXRFcnJvcnMobnVsbCk7XHJcbiAgICAgICAgICAgIGNvbnRyb2xSZXF1aXJlZC5tYXJrQXNVbnRvdWNoZWQoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKGNvbnRyb2xSZXF1aXJlZC5oYXNFcnJvcignaWZIYXZlT25lSXNSZXF1aXJlZCcpKSB7XHJcbiAgICAgICAgICBjb250cm9sUmVxdWlyZWQuc2V0RXJyb3JzKG51bGwpO1xyXG4gICAgICAgICAgY29udHJvbFJlcXVpcmVkLm1hcmtBc1VudG91Y2hlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFh1IGx5IGJhdCBidW9jIG5oYXAgdHJ1b25nIGhpZW4gdGFpIGtoaSB0cnVvbmcgdHJ1eWVuIHZhbyBjbyBnaWEgdHJpXHJcbiAgICogQHBhcmFtIGNvbnRyb2xLZXlzIFRlbiB0cnVvbmcgbmhhcCBnaWEgdHJpXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBpc1JlcXVpcmVkSWZIYXZlT25lKGNvbnRyb2xLZXlzOiBzdHJpbmcpOiBWYWxpZGF0b3JGbiB8IGFueXtcclxuICAgIHJldHVybiAoYzogQWJzdHJhY3RDb250cm9sKTogYW55IHwgbnVsbCA9PiB7XHJcbiAgICAgIGNvbnN0IGdyb3VwID0gYy5wYXJlbnQgYXMgRm9ybUdyb3VwO1xyXG4gICAgICBjb25zdCBjb250cm9sSGF2ZU9uZSA9IGdyb3VwLmdldChjb250cm9sS2V5cykgYXMgRm9ybUNvbnRyb2w7XHJcbiAgICAgIGlmIChjLnZhbHVlID09PSBudWxsIHx8IGMudmFsdWUgPT09ICcnKSB7XHJcbiAgICAgICAgaWYgKGNvbnRyb2xIYXZlT25lICYmIChjb250cm9sSGF2ZU9uZS52YWx1ZSA9PT0gbnVsbCB8fCBjb250cm9sSGF2ZU9uZS52YWx1ZS50b1N0cmluZygpLmxlbmd0aCA9PT0gMCkpIHsgLy8gIHZpIGNvIHRoIHZhbHVlID0gW11cclxuICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4geyBpZkhhdmVPbmVJc1JlcXVpcmVkOiB0cnVlIH07XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogdmFsaWRhdGUgYXJyYXkgZm9ybSByZXF1aXJkXHJcbiAgICogTmV1IGtvIG5oYXAgdHJ1b25nIG5hbyB0aGkga28gdmFsaWRhdGUsIGtoaSBuaGFwIDEgdHJvbmcgY2FjIHRydW9uZyAgdGhpIGJhdCBidW9jIG5oYXAgdGF0IGNhIGNhYyB0cnVvbmcgY2F1IGhpbmhcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIHJlcXVpcmVkQ29udHJvbEluR3JvdXAoY29udHJvbEtleXM6IEFycmF5PHN0cmluZz4sIGNvbnRyb2xLZXlzSWdub3JlPzogQXJyYXk8c3RyaW5nPik6IFZhbGlkYXRvckZuIHwgYW55e1xyXG4gICAgcmV0dXJuIChncm91cDogRm9ybUdyb3VwKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB8IG51bGwgPT4ge1xyXG4gICAgICBsZXQgY2hlY2tFeGl0c1ZhbHVlID0gZmFsc2U7XHJcbiAgICAgIE9iamVjdC5rZXlzKGdyb3VwLmNvbnRyb2xzKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgaWYgKGNvbnRyb2xLZXlzSWdub3JlICYmIGNvbnRyb2xLZXlzSWdub3JlLmluY2x1ZGVzKGtleSkpIHtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjb250cm9sRWwgPSBncm91cC5nZXQoa2V5KSBhcyBCYXNlQ29udHJvbDtcclxuICAgICAgICBpZiAoIShjb250cm9sRWwudmFsdWUgPT09IG51bGwgfHwgY29udHJvbEVsLnZhbHVlID09PSAnJyB8fCAhY29udHJvbEVsLnZhbHVlKSkge1xyXG4gICAgICAgICAgY2hlY2tFeGl0c1ZhbHVlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9KTtcclxuICAgICAgY29udHJvbEtleXMuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGZvcm1Db250cm9sID0gZ3JvdXAuY29udHJvbHNba2V5XTtcclxuICAgICAgICBpZiAoY2hlY2tFeGl0c1ZhbHVlKSB7XHJcbiAgICAgICAgICBpZiAoZm9ybUNvbnRyb2wudmFsdWUgPT09IG51bGwgfHwgZm9ybUNvbnRyb2wudmFsdWUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIGZvcm1Db250cm9sLnNldEVycm9ycyh7IHJlcXVpcmVkQ29udHJvbEluR3JvdXA6IHRydWUgfSk7XHJcbiAgICAgICAgICAgIC8vIGZvcm1Db250cm9sLm1hcmtBc1RvdWNoZWQoKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAoKCcnICsgZm9ybUNvbnRyb2wudmFsdWUpLnRyaW0oKSA9PT0gJycpIHtcclxuICAgICAgICAgICAgZm9ybUNvbnRyb2wuc2V0RXJyb3JzKHsgcmVxdWlyZWRDb250cm9sSW5Hcm91cDogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgLy8gZm9ybUNvbnRyb2wubWFya0FzVG91Y2hlZCgpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGZvcm1Db250cm9sLmhhc0Vycm9yKCdyZXF1aXJlZENvbnRyb2xJbkdyb3VwJykpIHtcclxuICAgICAgICAgICAgICBmb3JtQ29udHJvbC5zZXRFcnJvcnMobnVsbCk7XHJcbiAgICAgICAgICAgICAgZm9ybUNvbnRyb2wubWFya0FzVW50b3VjaGVkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKGZvcm1Db250cm9sLmhhc0Vycm9yKCdyZXF1aXJlZENvbnRyb2xJbkdyb3VwJykpIHtcclxuICAgICAgICAgICAgZm9ybUNvbnRyb2wuc2V0RXJyb3JzKG51bGwpO1xyXG4gICAgICAgICAgICBmb3JtQ29udHJvbC5tYXJrQXNVbnRvdWNoZWQoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBYdSBseSB2YWxpZGF0ZSBiYXQgYnVvYyBuaGFwIDEgdHJ1b25nIHRyb25nIGRhbmggc2FjaCBjYXUgaGluaFxyXG4gICovXHJcbiAgcHVibGljIHN0YXRpYyBqdXN0UmVxdWlyZWRPbmVGaWVsZChjb250cm9sS2V5czogQXJyYXk8c3RyaW5nPik6IFZhbGlkYXRvckZuIHwgYW55e1xyXG4gICAgcmV0dXJuIChncm91cDogRm9ybUdyb3VwKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB8IG51bGwgPT4ge1xyXG4gICAgICBsZXQgY2hlY2tFeGl0c1ZhbHVlID0gZmFsc2U7XHJcbiAgICAgIGNvbnRyb2xLZXlzLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICBjb25zdCBjb250cm9sRWwgPSBncm91cC5nZXQoa2V5KSBhcyBCYXNlQ29udHJvbDtcclxuICAgICAgICBpZiAoY29udHJvbEVsLnZhbHVlICE9PSBudWxsICYmIGNvbnRyb2xFbC52YWx1ZSAhPT0gJycpIHtcclxuICAgICAgICAgIGNoZWNrRXhpdHNWYWx1ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgY29udHJvbEtleXMuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGZvcm1Db250cm9sID0gZ3JvdXAuZ2V0KGtleSkgYXMgQmFzZUNvbnRyb2w7XHJcbiAgICAgICAgaWYgKGNoZWNrRXhpdHNWYWx1ZSkge1xyXG4gICAgICAgICAgaWYgKGZvcm1Db250cm9sLmhhc0Vycm9yKCdqdXN0UmVxdWlyZWRPbmVGaWVsZCcpKSB7XHJcbiAgICAgICAgICAgIGZvcm1Db250cm9sLnNldEVycm9ycyhudWxsKTtcclxuICAgICAgICAgICAgZm9ybUNvbnRyb2wubWFya0FzVW50b3VjaGVkKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmICghZm9ybUNvbnRyb2wuaGFzRXJyb3IoJ2p1c3RSZXF1aXJlZE9uZUZpZWxkJykpIHtcclxuICAgICAgICAgICAgZm9ybUNvbnRyb2wuc2V0RXJyb3JzKHsganVzdFJlcXVpcmVkT25lRmllbGQ6IHRydWUgfSk7XHJcbiAgICAgICAgICAgIC8vIGZvcm1Db250cm9sLm1hcmtBc1RvdWNoZWQoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBwb3NpdGl2ZVJlYWxOdW1iZXIoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogYW55IHtcclxuICAgIGlmICghY29udHJvbC52YWx1ZSkgeyByZXR1cm47IH1cclxuICAgIHJldHVybiAoY29udHJvbC52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5tYXRjaCgvXigoWzAtOV0rKShbXFwuXShbNV17MX0pKT8pJC8pKVxyXG4gICAgICA/ICcnIDogeyBwb3NpdGl2ZVJlYWxOdW1iZXI6IHRydWUgfTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgaXNSZXF1aXJlZElmSGF2ZU9uZVZhbHVlKGNvbnRyb2xLZXlzOiBzdHJpbmcpOiBWYWxpZGF0b3JGbiB8IGFueXtcclxuICAgIHJldHVybiAoYzogQWJzdHJhY3RDb250cm9sKTogYW55IHwgbnVsbCA9PiB7XHJcbiAgICAgIGNvbnN0IGdyb3VwID0gYy5wYXJlbnQgYXMgRm9ybUdyb3VwO1xyXG4gICAgICBjb25zdCBjb250cm9sSGF2ZU9uZSA9IGdyb3VwLmdldChjb250cm9sS2V5cykgYXMgRm9ybUNvbnRyb2w7XHJcbiAgICAgIGlmIChjLnZhbHVlID09PSBudWxsIHx8IGMudmFsdWUgPT0gXCJcIiB8fCBjLnZhbHVlLnRvU3RyaW5nKCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgaWYgKGNvbnRyb2xIYXZlT25lICYmIChjb250cm9sSGF2ZU9uZS52YWx1ZSA9PT0gbnVsbCB8fCBjb250cm9sSGF2ZU9uZS52YWx1ZSA9PT0gMCkpIHsgLy8gIHZpIGNvIHRoIHZhbHVlID0gW11cclxuICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4geyBpZkhhdmVPbmVJc1JlcXVpcmVkOiB0cnVlIH07XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBpc1JlcXVpcmVkUmVhc29uKHNhYmJhdGljYWxMZWF2ZUlkOiBzdHJpbmcsIGFkZERheTogc3RyaW5nLCBzdWJEYXk6IHN0cmluZyk6IFZhbGlkYXRvckZuIHwgYW55e1xyXG4gICAgcmV0dXJuIChjOiBBYnN0cmFjdENvbnRyb2wpOiBhbnkgfCBudWxsID0+IHtcclxuICAgICAgY29uc3QgZ3JvdXAgPSBjLnBhcmVudCBhcyBGb3JtR3JvdXA7XHJcbiAgICAgIGNvbnN0IGNvbnRyb2xTYWJiYXRpY2FsTGVhdmVJZCA9IGdyb3VwLmdldChzYWJiYXRpY2FsTGVhdmVJZCkgYXMgRm9ybUNvbnRyb2w7XHJcbiAgICAgIGNvbnN0IGNvbnRyb2xBZGRBbnV1YWxEYXlMZWF2ZSA9IGdyb3VwLmdldChhZGREYXkpIGFzIEZvcm1Db250cm9sO1xyXG4gICAgICBjb25zdCBjb250cm9sU3ViQW51dWFsRGF5TGVhdmUgPSBncm91cC5nZXQoc3ViRGF5KSBhcyBGb3JtQ29udHJvbDtcclxuICAgICAgaWYgKGNvbnRyb2xTYWJiYXRpY2FsTGVhdmVJZC52YWx1ZSkge1xyXG4gICAgICAgIGlmIChjLnZhbHVlID09PSBudWxsIHx8IGMudmFsdWUgPT09IFwiXCIpIHtcclxuICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4geyBpZkhhdmVPbmVJc1JlcXVpcmVkOiB0cnVlIH07XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChjb250cm9sU2FiYmF0aWNhbExlYXZlSWQudmFsdWUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgaWYgKGNvbnRyb2xBZGRBbnV1YWxEYXlMZWF2ZS52YWx1ZSAhPSBudWxsIHx8IGNvbnRyb2xTdWJBbnV1YWxEYXlMZWF2ZS52YWx1ZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChjLnZhbHVlID09PSBudWxsIHx8IGMudmFsdWUgPT09IFwiXCIpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgaWZIYXZlT25lSXNSZXF1aXJlZDogdHJ1ZSB9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgaXNIYXZlU2FiYmF0aWNhbExlYXZlSWQoY29udHJvbEtleXM6IHN0cmluZyk6IFZhbGlkYXRvckZuIHwgYW55e1xyXG4gICAgcmV0dXJuIChjOiBBYnN0cmFjdENvbnRyb2wpOiBhbnkgfCBudWxsID0+IHtcclxuICAgICAgY29uc3QgZ3JvdXAgPSBjLnBhcmVudCBhcyBGb3JtR3JvdXA7XHJcbiAgICAgIGNvbnN0IGNvbnRyb2xIYXZlT25lID0gZ3JvdXAuZ2V0KGNvbnRyb2xLZXlzKSBhcyBGb3JtQ29udHJvbDtcclxuICAgICAgaWYgKGNvbnRyb2xIYXZlT25lLnZhbHVlKSB7XHJcbiAgICAgICAgaWYgKGMudmFsdWUgPT09IG51bGwgfHwgYy52YWx1ZSA9PT0gXCJcIikge1xyXG4gICAgICAgICAgcmV0dXJuIHsgaWZIYXZlT25lSXNSZXF1aXJlZDogdHJ1ZSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZhbGlkYXRlIG51bWJlciBub3QgZ3JlYXRlciB0aGFuIG51bWJlciAoc2VsZWN0b3IpXHJcbiAgICogQHBhcmFtIHRhcmdldEtleTogYW55XHJcbiAgICogQHBhcmFtIHRvTWF0Y2hLZXk6IGFueVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgbm90R3JlYXRlcih0YXJnZXRLZXk6IHN0cmluZywgdG9NYXRjaEtleTogc3RyaW5nLCBsYWJlbE1hdGNoQ29kZTogc3RyaW5nKTogVmFsaWRhdG9yRm4gfCBhbnl7XHJcbiAgICByZXR1cm4gKGdyb3VwOiBGb3JtR3JvdXApOiB7IFtrZXk6IHN0cmluZ106IGFueSB9IHwgbnVsbCA9PiB7XHJcbiAgICAgIGNvbnN0IHRhcmdldCA9IGdyb3VwLmNvbnRyb2xzW3RhcmdldEtleV07XHJcbiAgICAgIGNvbnN0IHRvTWF0Y2ggPSBncm91cC5jb250cm9sc1t0b01hdGNoS2V5XTtcclxuICAgICAgaWYgKHRhcmdldC5oYXNFcnJvcignbnVtYmVyTm90R3JlYXRlcicpKSB7XHJcbiAgICAgICAgdGFyZ2V0LnNldEVycm9ycyhudWxsKTtcclxuICAgICAgICB0YXJnZXQubWFya0FzVW50b3VjaGVkKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0YXJnZXQudmFsdWUgJiYgdG9NYXRjaC52YWx1ZSkge1xyXG4gICAgICAgIGNvbnN0IGlzQ2hlY2sgPSBOdW1iZXIodGFyZ2V0LnZhbHVlKSA8PSBOdW1iZXIodG9NYXRjaC52YWx1ZSk7XHJcbiAgICAgICAgLy8gc2V0IGVxdWFsIHZhbHVlIGVycm9yIG9uIGRpcnR5IGNvbnRyb2xzXHJcbiAgICAgICAgaWYgKCFpc0NoZWNrICYmIHRhcmdldC52YWxpZCAmJiB0b01hdGNoLnZhbGlkKSB7XHJcbiAgICAgICAgICB0YXJnZXQuc2V0RXJyb3JzKHsgbnVtYmVyTm90R3JlYXRlcjogeyBudW1iZXJOb3RHcmVhdGVyOiBsYWJlbE1hdGNoQ29kZSB9IH0pO1xyXG4gICAgICAgICAgdGFyZ2V0Lm1hcmtBc1RvdWNoZWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiB2YWxpZGF0ZSBiZWZvcmVDdXJyZW50TW9udGhcclxuICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgYmVmb3JlQ3VycmVudE1vbnRoKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IGFueSB7XHJcbiAgICBpZiAoIWNvbnRyb2wudmFsdWUpIHsgcmV0dXJuOyB9XHJcbiAgICBjb25zdCB4ID0gbmV3IERhdGUoKS5nZXRNb250aCgpICsgMTtcclxuICAgIGNvbnN0IHkgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCk7XHJcbiAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKGNvbnRyb2wudmFsdWUpO1xyXG4gICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpICsgMTtcclxuICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgdmFyIGNoZWNrID0gZmFsc2U7XHJcbiAgICBpZiAoeWVhciA8IHkpIHtcclxuICAgICAgY2hlY2sgPSB0cnVlO1xyXG4gICAgfSBlbHNlIGlmICh5ZWFyID09IHkgJiYgbW9udGggPD0geCkge1xyXG4gICAgICBjaGVjayA9IHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gKGNoZWNrID09IHRydWUpXHJcbiAgICAgID8gJycgOiB7IGJlZm9yZUN1cnJlbnRNb250aDogdHJ1ZSB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBhZnRlckN1cnJlbnRNb250aChjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBhbnkge1xyXG4gICAgaWYgKCFjb250cm9sLnZhbHVlKSB7IHJldHVybjsgfVxyXG4gICAgY29uc3QgeCA9IG5ldyBEYXRlKCkuZ2V0TW9udGgoKSArIDE7XHJcbiAgICByZXR1cm4gKGNvbnRyb2wudmFsdWUgPj0geCB8fCB4IC0gY29udHJvbC52YWx1ZSA8IDk5OTk5OTk5KVxyXG4gICAgICA/ICcnIDogeyBhZnRlckN1cnJlbnRNb250aDogdHJ1ZSB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogdmFsaWRhdGUgOSBvciAxMlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgbGVuZ2h0OW9yMTIoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogYW55IHtcclxuICAgIGlmICghY29udHJvbC52YWx1ZSkgeyByZXR1cm47IH1cclxuICAgIHJldHVybiAoY29udHJvbC52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggPT0gOSB8fCBjb250cm9sLnZhbHVlLnRvU3RyaW5nKCkudHJpbSgpLmxlbmd0aCA9PSAxMikgPyAnJyA6IHsgbGVuZ2h0OW9yMTI6IHRydWUgfTtcclxuICB9XHJcbn1cclxuXHJcblxyXG4iXX0=