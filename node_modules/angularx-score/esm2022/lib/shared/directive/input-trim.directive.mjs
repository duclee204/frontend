import { Directive, ElementRef, HostListener, Inject, Input, Optional, Renderer2 } from '@angular/core';
import { COMPOSITION_BUFFER_MODE, NG_VALUE_ACCESSOR } from '@angular/forms';
import * as i0 from "@angular/core";
export class InputTrimDirective {
    set type(value) {
        this._type = value || 'text';
    }
    /**
     * Updates the value on the blur event.
     */
    onBlur(event, value) {
        this.updateValue(event, value.trim());
        this.onTouched();
    }
    /**
     * Updates the value on the input event.
     */
    onInput(event, value) {
        this.updateValue(event, value);
    }
    constructor(renderer, elementRef, compositionMode) {
        // Get a value of the trim attribute if it was set.
        this.trim = '';
        /**
         * Keep the type of input element in a cache.
         *
         */
        this._type = 'text';
        /**
         * Keep the value of input element in a cache.
         *
         */
        this._value = '';
        this.onChange = (_) => { };
        this.onTouched = () => { };
        this._sourceRenderer = renderer;
        this._sourceElementRef = elementRef;
    }
    registerOnChange(fn) { this.onChange = fn; }
    registerOnTouched(fn) { this.onTouched = fn; }
    /**
     * Writes a new value to the element based on the type of input element.
     *
     */
    writeValue(value) {
        //
        // The Template Driven Form doesn't automatically convert undefined values to null. We will do,
        // keeping an empty string as string because the condition `'' || null` returns null what
        // could change the initial state of a model.
        // The Reactive Form does it automatically during initialization.
        //
        // SEE: https://github.com/anein/angular2-trim-directive/issues/18
        //
        this._value = value;
        this._sourceRenderer.setProperty(this._sourceElementRef.nativeElement, 'value', this._value);
        // a dirty trick (or magic) goes here:
        // it updates the element value if `setProperty` doesn't set a new value for some reason.
        //
        // SEE: https://github.com/anein/angular2-trim-directive/issues/9
        //
        if (this._type !== 'text') {
            this._sourceRenderer.setAttribute(this._sourceElementRef.nativeElement, 'value', this._value);
        }
    }
    setDisabledState(isDisabled) {
        this._sourceRenderer.setProperty(this._sourceElementRef.nativeElement, 'disabled', isDisabled);
    }
    /**
     * Trims an input value, and sets it to the model and element.
     *
     */
    updateValue(event, value) {
        // check if the user has set an optional attribute, and Trimmmm!!! Uhahahaha!
        value = event === 'input' ? value : value.trim();
        const previous = this._value;
        // write value to the element.
        this.writeValue(value);
        // Update the model only on getting new value, and prevent firing
        // the `dirty` state when click on empty fields.
        //
        // SEE:
        //    https://github.com/anein/angular2-trim-directive/issues/17
        //    https://github.com/anein/angular2-trim-directive/issues/35
        //    https://github.com/anein/angular2-trim-directive/issues/39
        //
        if ((this._value || previous) && this._value.trim() !== previous) {
            this.onChange(this._value);
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.5", ngImport: i0, type: InputTrimDirective, deps: [{ token: Renderer2 }, { token: ElementRef }, { token: COMPOSITION_BUFFER_MODE, optional: true }], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "16.2.5", type: InputTrimDirective, selector: "input[type=\"text\"], textarea[]", inputs: { trim: "trim", type: "type" }, host: { listeners: { "blur": "onBlur($event.type,$event.target.value)", "input": "onInput($event.type,$event.target.value)" } }, providers: [{ provide: NG_VALUE_ACCESSOR, useExisting: InputTrimDirective, multi: true }], ngImport: i0 }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.5", ngImport: i0, type: InputTrimDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: 'input[type="text"], textarea[]',
                    providers: [{ provide: NG_VALUE_ACCESSOR, useExisting: InputTrimDirective, multi: true }]
                }]
        }], ctorParameters: function () { return [{ type: i0.Renderer2, decorators: [{
                    type: Inject,
                    args: [Renderer2]
                }] }, { type: i0.ElementRef, decorators: [{
                    type: Inject,
                    args: [ElementRef]
                }] }, { type: undefined, decorators: [{
                    type: Optional
                }, {
                    type: Inject,
                    args: [COMPOSITION_BUFFER_MODE]
                }] }]; }, propDecorators: { trim: [{
                type: Input
            }], type: [{
                type: Input
            }], onBlur: [{
                type: HostListener,
                args: ['blur', ['$event.type', '$event.target.value']]
            }], onInput: [{
                type: HostListener,
                args: ['input', ['$event.type', '$event.target.value']]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXQtdHJpbS5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9hbmd1bGFyeC1zY29yZS9zcmMvbGliL3NoYXJlZC9kaXJlY3RpdmUvaW5wdXQtdHJpbS5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN4RyxPQUFPLEVBQUUsdUJBQXVCLEVBQXdCLGlCQUFpQixFQUFlLE1BQU0sZ0JBQWdCLENBQUM7O0FBTS9HLE1BQU0sT0FBTyxrQkFBa0I7SUFJN0IsSUFDSSxJQUFJLENBQUMsS0FBYTtRQUNwQixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssSUFBSSxNQUFNLENBQUM7SUFDL0IsQ0FBQztJQWtCRDs7T0FFRztJQUVILE1BQU0sQ0FBQyxLQUFhLEVBQUUsS0FBYTtRQUNqQyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUN0QyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDbkIsQ0FBQztJQUVEOztPQUVHO0lBRUgsT0FBTyxDQUFDLEtBQWEsRUFBRSxLQUFhO1FBQ2xDLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFNRCxZQUNxQixRQUFtQixFQUNsQixVQUFzQixFQUNHLGVBQXdCO1FBaER2RSxtREFBbUQ7UUFDMUMsU0FBSSxHQUFXLEVBQUUsQ0FBQztRQU8zQjs7O1dBR0c7UUFDSyxVQUFLLEdBQUcsTUFBTSxDQUFDO1FBRXZCOzs7V0FHRztRQUNLLFdBQU0sR0FBVyxFQUFFLENBQUM7UUF1QjVCLGFBQVEsR0FBRyxDQUFDLENBQU0sRUFBRSxFQUFFLEdBQUUsQ0FBQyxDQUFDO1FBRTFCLGNBQVMsR0FBRyxHQUFHLEVBQUUsR0FBRSxDQUFDLENBQUM7UUFPbkIsSUFBSSxDQUFDLGVBQWUsR0FBRyxRQUFRLENBQUM7UUFDaEMsSUFBSSxDQUFDLGlCQUFpQixHQUFHLFVBQVUsQ0FBQztJQUN0QyxDQUFDO0lBRUQsZ0JBQWdCLENBQUMsRUFBb0IsSUFBVSxJQUFJLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFFcEUsaUJBQWlCLENBQUMsRUFBYyxJQUFVLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUVoRTs7O09BR0c7SUFDSSxVQUFVLENBQUMsS0FBVTtRQUMxQixFQUFFO1FBQ0YsK0ZBQStGO1FBQy9GLHlGQUF5RjtRQUN6Riw2Q0FBNkM7UUFDN0MsaUVBQWlFO1FBQ2pFLEVBQUU7UUFDRixrRUFBa0U7UUFDbEUsRUFBRTtRQUNGLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1FBRXBCLElBQUksQ0FBQyxlQUFlLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxhQUFhLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUU3RixzQ0FBc0M7UUFDdEMseUZBQXlGO1FBQ3pGLEVBQUU7UUFDRixpRUFBaUU7UUFDakUsRUFBRTtRQUNGLElBQUksSUFBSSxDQUFDLEtBQUssS0FBSyxNQUFNLEVBQUU7WUFDekIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLGFBQWEsRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQy9GO0lBQ0gsQ0FBQztJQUVELGdCQUFnQixDQUFDLFVBQW1CO1FBQ2xDLElBQUksQ0FBQyxlQUFlLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxhQUFhLEVBQUUsVUFBVSxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBQ2pHLENBQUM7SUFFRDs7O09BR0c7SUFDSyxXQUFXLENBQUMsS0FBYSxFQUFFLEtBQWE7UUFDOUMsNkVBQTZFO1FBQzdFLEtBQUssR0FBRyxLQUFLLEtBQUssT0FBTyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUVqRCxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO1FBRTdCLDhCQUE4QjtRQUM5QixJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRXZCLGlFQUFpRTtRQUNqRSxnREFBZ0Q7UUFDaEQsRUFBRTtRQUNGLE9BQU87UUFDUCxnRUFBZ0U7UUFDaEUsZ0VBQWdFO1FBQ2hFLGdFQUFnRTtRQUNoRSxFQUFFO1FBQ0YsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLElBQUksUUFBUSxDQUFDLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsS0FBSyxRQUFRLEVBQUU7WUFDaEUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDNUI7SUFDSCxDQUFDOzhHQWxIVSxrQkFBa0Isa0JBK0NuQixTQUFTLGFBQ1QsVUFBVSxhQUNFLHVCQUF1QjtrR0FqRGxDLGtCQUFrQixvT0FGbEIsQ0FBQyxFQUFFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxXQUFXLEVBQUUsa0JBQWtCLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFDOzsyRkFFOUUsa0JBQWtCO2tCQUo5QixTQUFTO21CQUFDO29CQUNULFFBQVEsRUFBRSxnQ0FBZ0M7b0JBQzFDLFNBQVMsRUFBRSxDQUFDLEVBQUUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLFdBQVcsb0JBQW9CLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFDO2lCQUMxRjs7MEJBZ0RJLE1BQU07MkJBQUMsU0FBUzs7MEJBQ2hCLE1BQU07MkJBQUMsVUFBVTs7MEJBQ2pCLFFBQVE7OzBCQUFJLE1BQU07MkJBQUMsdUJBQXVCOzRDQS9DcEMsSUFBSTtzQkFBWixLQUFLO2dCQUdGLElBQUk7c0JBRFAsS0FBSztnQkF5Qk4sTUFBTTtzQkFETCxZQUFZO3VCQUFDLE1BQU0sRUFBRSxDQUFDLGFBQWEsRUFBRSxxQkFBcUIsQ0FBQztnQkFVNUQsT0FBTztzQkFETixZQUFZO3VCQUFDLE9BQU8sRUFBRSxDQUFDLGFBQWEsRUFBRSxxQkFBcUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdGl2ZSwgRWxlbWVudFJlZiwgSG9zdExpc3RlbmVyLCBJbmplY3QsIElucHV0LCBPcHRpb25hbCwgUmVuZGVyZXIyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENPTVBPU0lUSU9OX0JVRkZFUl9NT0RFLCBDb250cm9sVmFsdWVBY2Nlc3NvciwgTkdfVkFMVUVfQUNDRVNTT1IsIEZvcm1Db250cm9sIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgc2VsZWN0b3I6ICdpbnB1dFt0eXBlPVwidGV4dFwiXSwgdGV4dGFyZWFbXScsXHJcbiAgcHJvdmlkZXJzOiBbeyBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUiwgdXNlRXhpc3Rpbmc6IElucHV0VHJpbURpcmVjdGl2ZSwgbXVsdGk6IHRydWUgfV1cclxufSlcclxuZXhwb3J0IGNsYXNzIElucHV0VHJpbURpcmVjdGl2ZSBpbXBsZW1lbnRzIENvbnRyb2xWYWx1ZUFjY2Vzc29yIHtcclxuICAvLyBHZXQgYSB2YWx1ZSBvZiB0aGUgdHJpbSBhdHRyaWJ1dGUgaWYgaXQgd2FzIHNldC5cclxuICBASW5wdXQoKSB0cmltOiBzdHJpbmcgPSAnJztcclxuXHJcbiAgQElucHV0KClcclxuICBzZXQgdHlwZSh2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLl90eXBlID0gdmFsdWUgfHwgJ3RleHQnO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogS2VlcCB0aGUgdHlwZSBvZiBpbnB1dCBlbGVtZW50IGluIGEgY2FjaGUuXHJcbiAgICpcclxuICAgKi9cclxuICBwcml2YXRlIF90eXBlID0gJ3RleHQnO1xyXG5cclxuICAvKipcclxuICAgKiBLZWVwIHRoZSB2YWx1ZSBvZiBpbnB1dCBlbGVtZW50IGluIGEgY2FjaGUuXHJcbiAgICpcclxuICAgKi9cclxuICBwcml2YXRlIF92YWx1ZTogc3RyaW5nID0gJyc7XHJcblxyXG4gIC8vIFNvdXJjZSBzZXJ2aWNlcyB0byBtb2RpZnkgZWxlbWVudHMuXHJcbiAgcHJpdmF0ZSBfc291cmNlUmVuZGVyZXI6IFJlbmRlcmVyMjtcclxuICBwcml2YXRlIF9zb3VyY2VFbGVtZW50UmVmOiBFbGVtZW50UmVmO1xyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGVzIHRoZSB2YWx1ZSBvbiB0aGUgYmx1ciBldmVudC5cclxuICAgKi9cclxuICBASG9zdExpc3RlbmVyKCdibHVyJywgWyckZXZlbnQudHlwZScsICckZXZlbnQudGFyZ2V0LnZhbHVlJ10pXHJcbiAgb25CbHVyKGV2ZW50OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMudXBkYXRlVmFsdWUoZXZlbnQsIHZhbHVlLnRyaW0oKSk7XHJcbiAgICB0aGlzLm9uVG91Y2hlZCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlcyB0aGUgdmFsdWUgb24gdGhlIGlucHV0IGV2ZW50LlxyXG4gICAqL1xyXG4gIEBIb3N0TGlzdGVuZXIoJ2lucHV0JywgWyckZXZlbnQudHlwZScsICckZXZlbnQudGFyZ2V0LnZhbHVlJ10pXHJcbiAgb25JbnB1dChldmVudDogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICB0aGlzLnVwZGF0ZVZhbHVlKGV2ZW50LCB2YWx1ZSk7XHJcbiAgfVxyXG5cclxuICBvbkNoYW5nZSA9IChfOiBhbnkpID0+IHt9O1xyXG5cclxuICBvblRvdWNoZWQgPSAoKSA9PiB7fTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBASW5qZWN0KFJlbmRlcmVyMikgcmVuZGVyZXI6IFJlbmRlcmVyMixcclxuICAgIEBJbmplY3QoRWxlbWVudFJlZikgZWxlbWVudFJlZjogRWxlbWVudFJlZixcclxuICAgIEBPcHRpb25hbCgpIEBJbmplY3QoQ09NUE9TSVRJT05fQlVGRkVSX01PREUpIGNvbXBvc2l0aW9uTW9kZTogYm9vbGVhblxyXG4gICkge1xyXG4gICAgdGhpcy5fc291cmNlUmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX3NvdXJjZUVsZW1lbnRSZWYgPSBlbGVtZW50UmVmO1xyXG4gIH1cclxuXHJcbiAgcmVnaXN0ZXJPbkNoYW5nZShmbjogKF86IGFueSkgPT4gdm9pZCk6IHZvaWQgeyB0aGlzLm9uQ2hhbmdlID0gZm47IH1cclxuXHJcbiAgcmVnaXN0ZXJPblRvdWNoZWQoZm46ICgpID0+IHZvaWQpOiB2b2lkIHsgdGhpcy5vblRvdWNoZWQgPSBmbjsgfVxyXG5cclxuICAvKipcclxuICAgKiBXcml0ZXMgYSBuZXcgdmFsdWUgdG8gdGhlIGVsZW1lbnQgYmFzZWQgb24gdGhlIHR5cGUgb2YgaW5wdXQgZWxlbWVudC5cclxuICAgKlxyXG4gICAqL1xyXG4gIHB1YmxpYyB3cml0ZVZhbHVlKHZhbHVlOiBhbnkpOiB2b2lkIHtcclxuICAgIC8vXHJcbiAgICAvLyBUaGUgVGVtcGxhdGUgRHJpdmVuIEZvcm0gZG9lc24ndCBhdXRvbWF0aWNhbGx5IGNvbnZlcnQgdW5kZWZpbmVkIHZhbHVlcyB0byBudWxsLiBXZSB3aWxsIGRvLFxyXG4gICAgLy8ga2VlcGluZyBhbiBlbXB0eSBzdHJpbmcgYXMgc3RyaW5nIGJlY2F1c2UgdGhlIGNvbmRpdGlvbiBgJycgfHwgbnVsbGAgcmV0dXJucyBudWxsIHdoYXRcclxuICAgIC8vIGNvdWxkIGNoYW5nZSB0aGUgaW5pdGlhbCBzdGF0ZSBvZiBhIG1vZGVsLlxyXG4gICAgLy8gVGhlIFJlYWN0aXZlIEZvcm0gZG9lcyBpdCBhdXRvbWF0aWNhbGx5IGR1cmluZyBpbml0aWFsaXphdGlvbi5cclxuICAgIC8vXHJcbiAgICAvLyBTRUU6IGh0dHBzOi8vZ2l0aHViLmNvbS9hbmVpbi9hbmd1bGFyMi10cmltLWRpcmVjdGl2ZS9pc3N1ZXMvMThcclxuICAgIC8vXHJcbiAgICB0aGlzLl92YWx1ZSA9IHZhbHVlO1xyXG5cclxuICAgIHRoaXMuX3NvdXJjZVJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMuX3NvdXJjZUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCwgJ3ZhbHVlJywgdGhpcy5fdmFsdWUpO1xyXG5cclxuICAgIC8vIGEgZGlydHkgdHJpY2sgKG9yIG1hZ2ljKSBnb2VzIGhlcmU6XHJcbiAgICAvLyBpdCB1cGRhdGVzIHRoZSBlbGVtZW50IHZhbHVlIGlmIGBzZXRQcm9wZXJ0eWAgZG9lc24ndCBzZXQgYSBuZXcgdmFsdWUgZm9yIHNvbWUgcmVhc29uLlxyXG4gICAgLy9cclxuICAgIC8vIFNFRTogaHR0cHM6Ly9naXRodWIuY29tL2FuZWluL2FuZ3VsYXIyLXRyaW0tZGlyZWN0aXZlL2lzc3Vlcy85XHJcbiAgICAvL1xyXG4gICAgaWYgKHRoaXMuX3R5cGUgIT09ICd0ZXh0Jykge1xyXG4gICAgICB0aGlzLl9zb3VyY2VSZW5kZXJlci5zZXRBdHRyaWJ1dGUodGhpcy5fc291cmNlRWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAndmFsdWUnLCB0aGlzLl92YWx1ZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgIHRoaXMuX3NvdXJjZVJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMuX3NvdXJjZUVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCwgJ2Rpc2FibGVkJywgaXNEaXNhYmxlZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUcmltcyBhbiBpbnB1dCB2YWx1ZSwgYW5kIHNldHMgaXQgdG8gdGhlIG1vZGVsIGFuZCBlbGVtZW50LlxyXG4gICAqXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB1cGRhdGVWYWx1ZShldmVudDogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAvLyBjaGVjayBpZiB0aGUgdXNlciBoYXMgc2V0IGFuIG9wdGlvbmFsIGF0dHJpYnV0ZSwgYW5kIFRyaW1tbW0hISEgVWhhaGFoYWhhIVxyXG4gICAgdmFsdWUgPSBldmVudCA9PT0gJ2lucHV0JyA/IHZhbHVlIDogdmFsdWUudHJpbSgpO1xyXG5cclxuICAgIGNvbnN0IHByZXZpb3VzID0gdGhpcy5fdmFsdWU7XHJcblxyXG4gICAgLy8gd3JpdGUgdmFsdWUgdG8gdGhlIGVsZW1lbnQuXHJcbiAgICB0aGlzLndyaXRlVmFsdWUodmFsdWUpO1xyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgbW9kZWwgb25seSBvbiBnZXR0aW5nIG5ldyB2YWx1ZSwgYW5kIHByZXZlbnQgZmlyaW5nXHJcbiAgICAvLyB0aGUgYGRpcnR5YCBzdGF0ZSB3aGVuIGNsaWNrIG9uIGVtcHR5IGZpZWxkcy5cclxuICAgIC8vXHJcbiAgICAvLyBTRUU6XHJcbiAgICAvLyAgICBodHRwczovL2dpdGh1Yi5jb20vYW5laW4vYW5ndWxhcjItdHJpbS1kaXJlY3RpdmUvaXNzdWVzLzE3XHJcbiAgICAvLyAgICBodHRwczovL2dpdGh1Yi5jb20vYW5laW4vYW5ndWxhcjItdHJpbS1kaXJlY3RpdmUvaXNzdWVzLzM1XHJcbiAgICAvLyAgICBodHRwczovL2dpdGh1Yi5jb20vYW5laW4vYW5ndWxhcjItdHJpbS1kaXJlY3RpdmUvaXNzdWVzLzM5XHJcbiAgICAvL1xyXG4gICAgaWYgKCh0aGlzLl92YWx1ZSB8fCBwcmV2aW91cykgJiYgdGhpcy5fdmFsdWUudHJpbSgpICE9PSBwcmV2aW91cykge1xyXG4gICAgICB0aGlzLm9uQ2hhbmdlKHRoaXMuX3ZhbHVlKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19