import { Component, EventEmitter, Input, Output } from '@angular/core';
import { BaseComponent } from '../base-component/base-component.component';
import { OrgSelectorDialogComponent } from '../org-selector-dialog/org-selector-dialog.component';
import { CommonUtils } from '../../services/common-utils.service';
import { BaseControl } from '../../models/base.control';
import * as i0 from "@angular/core";
import * as i1 from "primeng/dynamicdialog";
import * as i2 from "angular-l10n";
import * as i3 from "@angular/common";
import * as i4 from "primeng/button";
import * as i5 from "primeng/tooltip";
import * as i6 from "@angular/forms";
import * as i7 from "primeng/inputtext";
import * as i8 from "../control-messages/control-messages.component";
import * as i9 from "../../directive/input-special.directive";
import * as i10 from "../../directive/input-trim.directive";
export class OrgSelectorComponent extends BaseComponent {
    constructor(_injector, dialogService, translate) {
        super(_injector);
        this._injector = _injector;
        this.dialogService = dialogService;
        this.translate = translate;
        // formControl of this input
        this.property = new BaseControl();
        this.onChange = new EventEmitter();
        this.dataTable = {};
        this.orgName = '';
    }
    /**
     * ngOnInit
     */
    ngOnInit() {
    }
    /**
     * ngAfterViewInit
     */
    ngAfterViewInit() {
    }
    onSelect() {
        this.ref = this.dialogService.open(OrgSelectorDialogComponent, {
            header: this.translate.translate('common.orgSelector.select'),
            width: CommonUtils.setWidthDiaglog('60%'),
            contentStyle: { overflow: 'auto' },
            baseZIndex: 99999,
            maximizable: true,
            data: {
                orgService: this.orgService
            }
        });
        this.ref.onClose.subscribe((node) => {
            if (node) {
                this.orgName = node.name;
                this.property.setValue(!!this.fieldValue ? node[this.fieldValue] : node.id);
                // callback on chose item
                this.onChange.emit(node);
            }
        });
    }
    /**
     * ngOnChanges
     */
    ngOnChanges() {
        this.onChangeOrgId();
    }
    onChangeOrgId() {
        if (!this.property) {
            return;
        }
        if (!this.property.value || this.property.value == 0) {
            return;
        }
        if (this.fieldValue == 'code') {
            this.orgService.getByCode(this.property.value)
                .subscribe((res) => {
                const data = res.data;
                if (data) {
                    this.orgName = data.name;
                }
            });
        }
        else {
            // thuc hien lay ten don vi de hien thi
            this.orgService.findOne(this.property.value)
                .subscribe((res) => {
                const data = res.data;
                if (data) {
                    this.orgName = data.name;
                }
            });
        }
    }
    onClear() {
        this.orgName = '';
        this.property.setValue(null);
        this.onChange.emit(null);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.5", ngImport: i0, type: OrgSelectorComponent, deps: [{ token: i0.Injector }, { token: i1.DialogService }, { token: i2.L10nTranslationService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.2.5", type: OrgSelectorComponent, selector: "app-org-selector", inputs: { property: "property", labelValue: "labelValue", orgService: "orgService", fieldValue: "fieldValue" }, outputs: { onChange: "onChange" }, usesInheritance: true, usesOnChanges: true, ngImport: i0, template: "<div class=\"field\">\n    <label class=\"font-semibold\" [ngClass]=\"{'required': property.isRequire}\">{{ labelValue }}</label>\n    <div class=\"p-inputgroup w-full\">\n        <input class=\"flex-1\" type=\"text\" pInputText [(ngModel)]=\"orgName\" [pTooltip]=\"orgName\" (click)=\"onSelect()\"/>\n        <button\n            type=\"button\"\n            pButton\n            icon=\"pi pi-times\"\n            class=\"p-button-danger\"\n            [pTooltip]=\"'common.orgSelector.clear' | translateAsync\"\n            (click)=\"onClear()\"></button>\n        <button\n            type=\"button\"\n            pButton\n            icon=\"pi pi-check\"\n            class=\"p-button-info\"\n            [pTooltip]=\"'common.orgSelector.select' | translateAsync\"\n            (click)=\"onSelect()\"></button>\n    </div>\n    <app-control-messages [control]=\"property\"></app-control-messages>\n</div>\n", styles: ["::ng-deep app-org-selector input{padding:0 .5rem!important}\n"], dependencies: [{ kind: "directive", type: i3.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i4.ButtonDirective, selector: "[pButton]", inputs: ["iconPos", "loadingIcon", "label", "icon", "loading"] }, { kind: "directive", type: i5.Tooltip, selector: "[pTooltip]", inputs: ["tooltipPosition", "tooltipEvent", "appendTo", "positionStyle", "tooltipStyleClass", "tooltipZIndex", "escape", "showDelay", "hideDelay", "life", "positionTop", "positionLeft", "autoHide", "fitContent", "hideOnEscape", "pTooltip", "tooltipDisabled", "tooltipOptions"] }, { kind: "directive", type: i6.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i6.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i6.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }, { kind: "directive", type: i7.InputText, selector: "[pInputText]" }, { kind: "component", type: i8.ControlMessagesComponent, selector: "app-control-messages", inputs: ["control", "labelName"] }, { kind: "directive", type: i9.InputSpecialDirective, selector: "input[type=\"text\"],input[type=\"email\"],input[type=\"tel\"],input:not([othertype=\"url\"]),textarea", inputs: ["type", "othertype"] }, { kind: "directive", type: i10.InputTrimDirective, selector: "input[type=\"text\"], textarea[]", inputs: ["trim", "type"] }, { kind: "pipe", type: i2.L10nTranslateAsyncPipe, name: "translateAsync" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.5", ngImport: i0, type: OrgSelectorComponent, decorators: [{
            type: Component,
            args: [{ selector: 'app-org-selector', template: "<div class=\"field\">\n    <label class=\"font-semibold\" [ngClass]=\"{'required': property.isRequire}\">{{ labelValue }}</label>\n    <div class=\"p-inputgroup w-full\">\n        <input class=\"flex-1\" type=\"text\" pInputText [(ngModel)]=\"orgName\" [pTooltip]=\"orgName\" (click)=\"onSelect()\"/>\n        <button\n            type=\"button\"\n            pButton\n            icon=\"pi pi-times\"\n            class=\"p-button-danger\"\n            [pTooltip]=\"'common.orgSelector.clear' | translateAsync\"\n            (click)=\"onClear()\"></button>\n        <button\n            type=\"button\"\n            pButton\n            icon=\"pi pi-check\"\n            class=\"p-button-info\"\n            [pTooltip]=\"'common.orgSelector.select' | translateAsync\"\n            (click)=\"onSelect()\"></button>\n    </div>\n    <app-control-messages [control]=\"property\"></app-control-messages>\n</div>\n", styles: ["::ng-deep app-org-selector input{padding:0 .5rem!important}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.Injector }, { type: i1.DialogService }, { type: i2.L10nTranslationService }]; }, propDecorators: { property: [{
                type: Input
            }], labelValue: [{
                type: Input
            }], orgService: [{
                type: Input
            }], fieldValue: [{
                type: Input
            }], onChange: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3JnLXNlbGVjdG9yLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2FuZ3VsYXJ4LXNjb3JlL3NyYy9saWIvc2hhcmVkL2NvbXBvbmVudHMvb3JnLXNlbGVjdG9yL29yZy1zZWxlY3Rvci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9hbmd1bGFyeC1zY29yZS9zcmMvbGliL3NoYXJlZC9jb21wb25lbnRzL29yZy1zZWxlY3Rvci9vcmctc2VsZWN0b3IuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFpQixTQUFTLEVBQUUsWUFBWSxFQUFZLEtBQUssRUFBcUIsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ25ILE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw0Q0FBNEMsQ0FBQztBQUUzRSxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxzREFBc0QsQ0FBQztBQUVsRyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFDbEUsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDJCQUEyQixDQUFDOzs7Ozs7Ozs7Ozs7QUFPeEQsTUFBTSxPQUFPLG9CQUFxQixTQUFRLGFBQWE7SUFvQnJELFlBQ1UsU0FBbUIsRUFDcEIsYUFBNEIsRUFDNUIsU0FBaUM7UUFHeEMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBTFQsY0FBUyxHQUFULFNBQVMsQ0FBVTtRQUNwQixrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQUM1QixjQUFTLEdBQVQsU0FBUyxDQUF3QjtRQXRCMUMsNEJBQTRCO1FBRXJCLGFBQVEsR0FBZ0IsSUFBSSxXQUFXLEVBQUUsQ0FBQztRQVkxQyxhQUFRLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7UUFHN0QsY0FBUyxHQUFRLEVBQUUsQ0FBQztRQUNwQixZQUFPLEdBQUcsRUFB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OytCQUNFLGtCQUFrQjtnS0FPckIsUUFBUTtzQkFEZCxLQUFLO2dCQUlDLFVBQVU7c0JBRGhCLEtBQUs7Z0JBSUMsVUFBVTtzQkFEaEIsS0FBSztnQkFJQyxVQUFVO3NCQURoQixLQUFLO2dCQUlDLFFBQVE7c0JBRGQsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFmdGVyVmlld0luaXQsIENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBJbmplY3RvciwgSW5wdXQsIE9uQ2hhbmdlcywgT25Jbml0LCBPdXRwdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQmFzZUNvbXBvbmVudCB9IGZyb20gJy4uL2Jhc2UtY29tcG9uZW50L2Jhc2UtY29tcG9uZW50LmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IERpYWxvZ1NlcnZpY2UsIER5bmFtaWNEaWFsb2dSZWYgfSBmcm9tICdwcmltZW5nL2R5bmFtaWNkaWFsb2cnO1xyXG5pbXBvcnQgeyBPcmdTZWxlY3RvckRpYWxvZ0NvbXBvbmVudCB9IGZyb20gJy4uL29yZy1zZWxlY3Rvci1kaWFsb2cvb3JnLXNlbGVjdG9yLWRpYWxvZy5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBMMTBuVHJhbnNsYXRpb25TZXJ2aWNlIH0gZnJvbSAnYW5ndWxhci1sMTBuJztcclxuaW1wb3J0IHsgQ29tbW9uVXRpbHMgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9jb21tb24tdXRpbHMuc2VydmljZSc7XHJcbmltcG9ydCB7IEJhc2VDb250cm9sIH0gZnJvbSAnLi4vLi4vbW9kZWxzL2Jhc2UuY29udHJvbCc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2FwcC1vcmctc2VsZWN0b3InLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9vcmctc2VsZWN0b3IuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL29yZy1zZWxlY3Rvci5jb21wb25lbnQuc2NzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBPcmdTZWxlY3RvckNvbXBvbmVudCBleHRlbmRzIEJhc2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uQ2hhbmdlcyB7XHJcbiAgLy8gZm9ybUNvbnRyb2wgb2YgdGhpcyBpbnB1dFxyXG4gIEBJbnB1dCgpXHJcbiAgcHVibGljIHByb3BlcnR5OiBCYXNlQ29udHJvbCA9IG5ldyBCYXNlQ29udHJvbCgpO1xyXG4gIC8vIHRpdGxlIGZvciBsYWJsZVxyXG4gIEBJbnB1dCgpXHJcbiAgcHVibGljIGxhYmVsVmFsdWUhOiBzdHJpbmc7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgcHVibGljIG9yZ1NlcnZpY2UhOiBhbnk7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgcHVibGljIGZpZWxkVmFsdWUhOiBzdHJpbmc7XHJcblxyXG4gIEBPdXRwdXQoKVxyXG4gIHB1YmxpYyBvbkNoYW5nZTogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgcmVmOiBEeW5hbWljRGlhbG9nUmVmIHwgdW5kZWZpbmVkO1xyXG4gIGRhdGFUYWJsZTogYW55ID0ge307XHJcbiAgb3JnTmFtZSA9ICcnO1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBfaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgcHVibGljIGRpYWxvZ1NlcnZpY2U6IERpYWxvZ1NlcnZpY2UsXHJcbiAgICBwdWJsaWMgdHJhbnNsYXRlOiBMMTBuVHJhbnNsYXRpb25TZXJ2aWNlLFxyXG4gICAgLy8gcHVibGljIG9yZ1NlcnZpY2U6IE9yZ2FuaXphdGlvblNlcnZpY2VcclxuICApIHtcclxuICAgIHN1cGVyKF9pbmplY3Rvcik7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogbmdPbkluaXRcclxuICAgKi9cclxuICBuZ09uSW5pdCgpIHtcclxuICB9XHJcbiAgLyoqXHJcbiAgICogbmdBZnRlclZpZXdJbml0XHJcbiAgICovXHJcbiAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gIH1cclxuXHJcbiAgb25TZWxlY3QoKSB7XHJcbiAgICB0aGlzLnJlZiA9IHRoaXMuZGlhbG9nU2VydmljZS5vcGVuKE9yZ1NlbGVjdG9yRGlhbG9nQ29tcG9uZW50LCB7XHJcbiAgICAgIGhlYWRlcjogdGhpcy50cmFuc2xhdGUudHJhbnNsYXRlKCdjb21tb24ub3JnU2VsZWN0b3Iuc2VsZWN0JyksXHJcbiAgICAgIHdpZHRoOiBDb21tb25VdGlscy5zZXRXaWR0aERpYWdsb2coJzYwJScpLFxyXG4gICAgICBjb250ZW50U3R5bGU6IHsgb3ZlcmZsb3c6ICdhdXRvJyB9LFxyXG4gICAgICBiYXNlWkluZGV4OiA5OTk5OSxcclxuICAgICAgbWF4aW1pemFibGU6IHRydWUsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICBvcmdTZXJ2aWNlOiB0aGlzLm9yZ1NlcnZpY2VcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLnJlZi5vbkNsb3NlLnN1YnNjcmliZSgobm9kZSkgPT4ge1xyXG4gICAgICBpZiAobm9kZSkge1xyXG4gICAgICAgIHRoaXMub3JnTmFtZSA9IG5vZGUubmFtZTtcclxuICAgICAgICB0aGlzLnByb3BlcnR5LnNldFZhbHVlKCEhdGhpcy5maWVsZFZhbHVlID8gbm9kZVt0aGlzLmZpZWxkVmFsdWVdIDogbm9kZS5pZCk7XHJcbiAgICAgICAgLy8gY2FsbGJhY2sgb24gY2hvc2UgaXRlbVxyXG4gICAgICAgIHRoaXMub25DaGFuZ2UuZW1pdChub2RlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBuZ09uQ2hhbmdlc1xyXG4gICAqL1xyXG4gIG5nT25DaGFuZ2VzKCkge1xyXG4gICAgdGhpcy5vbkNoYW5nZU9yZ0lkKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb25DaGFuZ2VPcmdJZCgpIHtcclxuICAgIGlmICghdGhpcy5wcm9wZXJ0eSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoIXRoaXMucHJvcGVydHkudmFsdWUgfHwgdGhpcy5wcm9wZXJ0eS52YWx1ZSA9PSAwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmZpZWxkVmFsdWUgPT0gJ2NvZGUnKSB7XHJcbiAgICAgIHRoaXMub3JnU2VydmljZS5nZXRCeUNvZGUodGhpcy5wcm9wZXJ0eS52YWx1ZSlcclxuICAgICAgICAuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZGF0YSA9IHJlcy5kYXRhO1xyXG4gICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5vcmdOYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gdGh1YyBoaWVuIGxheSB0ZW4gZG9uIHZpIGRlIGhpZW4gdGhpXHJcbiAgICAgIHRoaXMub3JnU2VydmljZS5maW5kT25lKHRoaXMucHJvcGVydHkudmFsdWUpXHJcbiAgICAgICAgLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXMuZGF0YTtcclxuICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3JnTmFtZSA9IGRhdGEubmFtZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uQ2xlYXIoKSB7XHJcbiAgICB0aGlzLm9yZ05hbWUgPSAnJztcclxuICAgIHRoaXMucHJvcGVydHkuc2V0VmFsdWUobnVsbCk7XHJcbiAgICB0aGlzLm9uQ2hhbmdlLmVtaXQobnVsbCk7XHJcbiAgfVxyXG59XHJcbiIsIjxkaXYgY2xhc3M9XCJmaWVsZFwiPlxuICAgIDxsYWJlbCBjbGFzcz1cImZvbnQtc2VtaWJvbGRcIiBbbmdDbGFzc109XCJ7J3JlcXVpcmVkJzogcHJvcGVydHkuaXNSZXF1aXJlfVwiPnt7IGxhYmVsVmFsdWUgfX08L2xhYmVsPlxuICAgIDxkaXYgY2xhc3M9XCJwLWlucHV0Z3JvdXAgdy1mdWxsXCI+XG4gICAgICAgIDxpbnB1dCBjbGFzcz1cImZsZXgtMVwiIHR5cGU9XCJ0ZXh0XCIgcElucHV0VGV4dCBbKG5nTW9kZWwpXT1cIm9yZ05hbWVcIiBbcFRvb2x0aXBdPVwib3JnTmFtZVwiIChjbGljayk9XCJvblNlbGVjdCgpXCIvPlxuICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgIHBCdXR0b25cbiAgICAgICAgICAgIGljb249XCJwaSBwaS10aW1lc1wiXG4gICAgICAgICAgICBjbGFzcz1cInAtYnV0dG9uLWRhbmdlclwiXG4gICAgICAgICAgICBbcFRvb2x0aXBdPVwiJ2NvbW1vbi5vcmdTZWxlY3Rvci5jbGVhcicgfCB0cmFuc2xhdGVBc3luY1wiXG4gICAgICAgICAgICAoY2xpY2spPVwib25DbGVhcigpXCI+PC9idXR0b24+XG4gICAgICAgIDxidXR0b25cbiAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgcEJ1dHRvblxuICAgICAgICAgICAgaWNvbj1cInBpIHBpLWNoZWNrXCJcbiAgICAgICAgICAgIGNsYXNzPVwicC1idXR0b24taW5mb1wiXG4gICAgICAgICAgICBbcFRvb2x0aXBdPVwiJ2NvbW1vbi5vcmdTZWxlY3Rvci5zZWxlY3QnIHwgdHJhbnNsYXRlQXN5bmNcIlxuICAgICAgICAgICAgKGNsaWNrKT1cIm9uU2VsZWN0KClcIj48L2J1dHRvbj5cbiAgICA8L2Rpdj5cbiAgICA8YXBwLWNvbnRyb2wtbWVzc2FnZXMgW2NvbnRyb2xdPVwicHJvcGVydHlcIj48L2FwcC1jb250cm9sLW1lc3NhZ2VzPlxuPC9kaXY+XG4iXX0=